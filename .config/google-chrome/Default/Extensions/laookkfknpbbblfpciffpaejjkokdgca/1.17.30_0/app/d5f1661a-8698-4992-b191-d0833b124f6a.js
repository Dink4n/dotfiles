var fn_addin=function(b,i,t){var L=L||{};return L.styles=L.styles||{},L.commands=L.commands||{},L.dependencies=t||L.dependencies||{},L.styles.style=function(){},L.views=L.views||{},L.collect=L.collect||{},L.models=L.models||{},L.templates=L.templates||{},L.info={widget:!0,placeholderType:"metric",id:"weather",class:"app-container weather",region:"top-right",order:"prepend",addin:"d5f1661a-8698-4992-b191-d0833b124f6a",toggleEvent:"globalEvent:key:W",visibleSetting:"weatherVisible"},b.console.log(b.elapsed()+": "+L.info.id+" started"),L.templates=L.templates||{},L.templates.weather=Handlebars.template({1:function(t,e,a,i){var n,o,s=this.lambda,l=this.escapeExpression,r=e.helperMissing,c="function";return'\t\t\t<span class="icon icon-weather" data-icon="'+l(s(null!=(n=null!=t?t.now:t)?n.icon:n,t))+'" title="'+l(s(null!=(n=null!=t?t.now:t)?n.condition:n,t))+'"></span><span class="metric-stat-number" data-test="temperature">'+l(s(null!=(n=null!=t?t.now:t)?n.temperature:n,t))+'</span><span class="weather-degree">&deg;</span><span class="unit '+l(typeof(o=null!=(o=e.unitClass||(null!=t?t.unitClass:t))?o:r)==c?o.call(t,{name:"unitClass",hash:{},data:i}):o)+'">'+l(typeof(o=null!=(o=e.unit||(null!=t?t.unit:t))?o:r)==c?o.call(t,{name:"unit",hash:{},data:i}):o)+"</span>\n"},3:function(t,e,a,i){return"\t\t\t&nbsp;\n"},5:function(t,e,a,i){return"plus-weather"},7:function(t,e,a,i){return"loading"},9:function(t,e,a,i){var n;return'\t\t\t\t\t\t\t<span class="weather-header-message" data-test="forecast-full-day-label">'+this.escapeExpression("function"==typeof(n=null!=(n=e.displayDay||(null!=t?t.displayDay:t))?n:e.helperMissing)?n.call(t,{name:"displayDay",hash:{},data:i}):n)+"</span>\n"},11:function(t,e,a,i){var n;return'\t\t\t\t\t\t\t<span class="weather-header-message">'+this.escapeExpression("function"==typeof(n=null!=(n=e.message||(null!=t?t.message:t))?n:e.helperMissing)?n.call(t,{name:"message",hash:{},data:i}):n)+"</span>\n"},13:function(t,e,a,i){return'\t\t\t\t\t\t\t\t<li class="weather-attribution no-hover">\n\t\t\t\t\t\t\t\t\t<img class="weather-attribution-logo" src="../img/logo-accuweather.png">\n\t\t\t\t\t\t\t\t</li>\n'},15:function(t,e,a,i){var n;return null!=(n=e.if.call(t,null!=t?t.today:t,{name:"if",hash:{},fn:this.program(16,i,0),inverse:this.noop,data:i}))?n:""},16:function(t,e,a,i){return'<i class="icon-angle-down"></i>'},18:function(t,e,a,i){var n;return'<span class="weather-current-temp">'+this.escapeExpression(this.lambda(null!=(n=null!=t?t.selected:t)?n.temperature:n,t))+"&deg;</span>"},20:function(t,e,a,i){var n,o=this.lambda,s=this.escapeExpression;return'<span class="weather-current-temp" data-test="future-day-high-temp">'+s(o(null!=(n=null!=t?t.selected:t)?n.high:n,t))+'&deg;</span><span class="weather-current-temp-low">'+s(o(null!=(n=null!=t?t.selected:t)?n.low:n,t))+"&deg;</span>"},22:function(t,e,a,i){var n;return'\t\t\t\t<div class="weather-current-details toggle-details" data-test="toggle-details-div">\n\t\t\t\t\t'+(null!=(n=e.if.call(t,null!=t?t.today:t,{name:"if",hash:{},fn:this.program(23,i,0),inverse:this.program(26,i,0),data:i}))?n:"")+(null!=(n=e.if.call(t,null!=(n=null!=t?t.selected:t)?n.precipitationExpected:n,{name:"if",hash:{},fn:this.program(29,i,0),inverse:this.noop,data:i}))?n:"")+(null!=(n=e.if.call(t,null!=(n=null!=t?t.selected:t)?n.windSpeed:n,{name:"if",hash:{},fn:this.program(31,i,0),inverse:this.noop,data:i}))?n:"")+"\t\t\t\t</div>\n"},23:function(t,e,a,i){var n;return null!=(n=e.if.call(t,null!=(n=null!=t?t.selected:t)?n.apparentTemperature:n,{name:"if",hash:{},fn:this.program(24,i,0),inverse:this.noop,data:i}))?n:""},24:function(t,e,a,i){var n,o=this.lambda,s=this.escapeExpression;return'<i class="icon-angle-down"></i>\n\t\t\t\t\t<div title="'+s(o(null!=(n=null!=t?t.selected:t)?n.hoursOfSun:n,t))+' hours of sun">\n\t\t\t\t\t\t<span class="weather-current-details-title">Feels like</span>\n\t\t\t\t\t\t<span class="weather-current-details-value"  >\n\t\t\t\t\t\t\t'+s(o(null!=(n=null!=t?t.selected:t)?n.apparentTemperature:n,t))+"&deg;\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n"},26:function(t,e,a,i){var n;return null!=(n=e.if.call(t,null!=(n=null!=t?t.selected:t)?n.apparentHigh:n,{name:"if",hash:{},fn:this.program(27,i,0),inverse:this.noop,data:i}))?n:""},27:function(t,e,a,i){var n,o=this.lambda,s=this.escapeExpression;return'\t\t\t\t\t\t<div title="'+s(o(null!=(n=null!=t?t.selected:t)?n.hoursOfSun:n,t))+' hours of sun">\n\t\t\t\t\t\t\t<span class="weather-current-details-title">Feels like</span>\n\t\t\t\t\t\t\t<span class="weather-current-details-value"  >\n\t\t\t\t\t\t\t\t'+s(o(null!=(n=null!=t?t.selected:t)?n.apparentHigh:n,t))+'&deg;<span class="weather-current-details-value-low">'+s(o(null!=(n=null!=t?t.selected:t)?n.apparentLow:n,t))+"&deg;</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n"},29:function(t,e,a,i){var n,o=this.lambda,s=this.escapeExpression;return'\t\t\t\t\t\t<div title="'+s(o(null!=(n=null!=t?t.selected:t)?n.precipitationExpected:n,t))+" "+s(o(null!=(n=null!=t?t.selected:t)?n.precipType:n,t))+' expected">\n\t\t\t\t\t\t\t<span class="weather-current-details-title">Chance of '+s(o(null!=(n=null!=t?t.selected:t)?n.precipType:n,t))+'</span>\n\t\t\t\t\t\t\t<span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.precipChance:n,t))+"%</span>\n\t\t\t\t\t\t</div>\n"},31:function(t,e,a,i){var n,o=this.lambda,s=this.escapeExpression;return'\t\t\t\t\t\t<div title="Gust '+s(o(null!=(n=null!=t?t.now:t)?n.windGust:n,t))+'">\n\t\t\t\t\t\t\t<span class="weather-current-details-title">Wind</span>\n\t\t\t\t\t\t\t<span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.windSpeed:n,t))+" "+(null!=(n=e.if.call(t,null!=(n=null!=t?t.selected:t)?n.windSpeed:n,{name:"if",hash:{},fn:this.program(32,i,0),inverse:this.noop,data:i}))?n:"")+"</span>\n\t\t\t\t\t\t</div>\n"},32:function(t,e,a,i){var n;return'<svg class="weather-arrow" style="transform: rotate('+this.escapeExpression(this.lambda(null!=(n=null!=t?t.selected:t)?n.windDirection:n,t))+'deg)" xmlns="http://www.w3.org/2000/svg" width="73.168" height="73.168" viewBox="0 0 73.168 73.168"><path d="M58.079 22.316L40.682 1.633A4.581 4.581 0 0 0 37.249 0c-1.392.075-2.599.534-3.485 1.52L15.185 22.204a4.584 4.584 0 0 0 .35 6.468 4.583 4.583 0 0 0 6.472-.354l10.109-11.253v51.531a4.578 4.578 0 0 0 4.584 4.572 4.577 4.577 0 0 0 4.581-4.572v-52.02l9.785 11.63a4.554 4.554 0 0 0 3.509 1.632 4.591 4.591 0 0 0 2.945-1.068 4.58 4.58 0 0 0 .559-6.454z"/></svg>'},34:function(t,e,a,i){var n,o=this.lambda,s=this.escapeExpression;return'\t\t\t<div class="weather-row weather-optional weather-hourly '+(null!=(n=e.if.call(t,null!=t?t.hourlyVisible:t,{name:"if",hash:{},fn:this.program(35,i,0),inverse:this.noop,data:i}))?n:"")+'" data-test="weather-hourly">\n\t\t\t\t<div class="weather-forecast weather-forecast-hourly">\n'+(null!=(n=e.each.call(t,null!=t?t.hours:t,{name:"each",hash:{},fn:this.program(37,i,0),inverse:this.noop,data:i}))?n:"")+'\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="weather-row weather-optional weather-detail '+(null!=(n=e.if.call(t,null!=t?t.detailVisible:t,{name:"if",hash:{},fn:this.program(35,i,0),inverse:this.noop,data:i}))?n:"")+'" data-test="weather-details">\n\t\t\t\t<div class="weather-extra">\n\t\t\t\t\t<div class="weather-extra-col">\n\t\t\t\t\t\t<div class="weather-extra-cell" title="Moon '+s(o(null!=(n=null!=t?t.selected:t)?n.moonPhase:n,t))+'">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Sunrise</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.sunrise:n,t))+'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Sunset</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.sunset:n,t))+'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="weather-extra-cell">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Dewpoint</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.dewPoint:n,t))+'&deg;</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="pressure-text">\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Pressure</span> <span class="weather-current-details-value" '+(null!=(n=e.unless.call(t,null!=(n=null!=t?t.selected:t)?n.pressureDirectionVisible:n,{name:"unless",hash:{},fn:this.program(39,i,0),inverse:this.noop,data:i}))?n:"")+">"+(null!=(n=e.if.call(t,null!=(n=null!=t?t.selected:t)?n.pressureDirectionVisible:n,{name:"if",hash:{},fn:this.program(41,i,0),inverse:this.noop,data:i}))?n:"")+s(o(null!=(n=null!=t?t.selected:t)?n.pressure:n,t))+'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="weather-extra-col">\n\t\t\t\t\t\t<div class="weather-extra-cell">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Humidity</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.humidity:n,t))+'%</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div title="In the past 24 hours">\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Precipitation</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.precipAmount:n,t))+'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="weather-extra-cell">\n\t\t\t\t\t\t\t<div title="'+s(o(null!=(n=null!=t?t.selected:t)?n.uvIndexText:n,t))+'">\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">UV Index</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.uvIndex:n,t))+'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div title="'+s(o(null!=(n=null!=t?t.selected:t)?n.visibilityText:n,t))+'">\n\t\t\t\t\t\t\t\t<span class="weather-current-details-title">Visibility</span> <span class="weather-current-details-value">'+s(o(null!=(n=null!=t?t.selected:t)?n.visibility:n,t))+'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="weather-row weather-detail-unavailable '+(null!=(n=e.if.call(t,null!=t?t.unavailableVisible:t,{name:"if",hash:{},fn:this.program(43,i,0),inverse:this.noop,data:i}))?n:"")+'">\n\t\t\t\t<span>Extra info unavailable on extended forecast.</span>\n\t\t\t</div>\n'},35:function(t,e,a,i){return"active"},37:function(t,e,a,i){var n,o=e.helperMissing,s="function",l=this.escapeExpression;return'\t\t\t\t\t<div class="weather-forecast-item" title="'+l(typeof(n=null!=(n=e.condition||(null!=t?t.condition:t))?n:o)==s?n.call(t,{name:"condition",hash:{},data:i}):n)+" ("+l(typeof(n=null!=(n=e.precipChance||(null!=t?t.precipChance:t))?n:o)==s?n.call(t,{name:"precipChance",hash:{},data:i}):n)+"% chance of "+l(typeof(n=null!=(n=e.precipType||(null!=t?t.precipType:t))?n:o)==s?n.call(t,{name:"precipType",hash:{},data:i}):n)+", "+l(typeof(n=null!=(n=e.windSpeed||(null!=t?t.windSpeed:t))?n:o)==s?n.call(t,{name:"windSpeed",hash:{},data:i}):n)+' wind)">\n\t\t\t\t\t\t<div class="weather-forecast-label">'+l(typeof(n=null!=(n=e.hour||(null!=t?t.hour:t))?n:o)==s?n.call(t,{name:"hour",hash:{},data:i}):n)+'</div>\n\t\t\t\t\t\t<span class="icon icon-weather weather-forecast-icon" data-icon="'+l(typeof(n=null!=(n=e.icon||(null!=t?t.icon:t))?n:o)==s?n.call(t,{name:"icon",hash:{},data:i}):n)+'"></span>\n\t\t\t\t\t\t<div class="weather-forecast-high">'+l(typeof(n=null!=(n=e.temperature||(null!=t?t.temperature:t))?n:o)==s?n.call(t,{name:"temperature",hash:{},data:i}):n)+"&deg;</div>\n\t\t\t\t\t</div>\n"},39:function(t,e,a,i){var n;return'title="'+this.escapeExpression(this.lambda(null!=(n=null!=t?t.selected:t)?n.pressureTendency:n,t))+'"'},41:function(t,e,a,i){var n;return'<svg class="weather-arrow weather-arrow-pressure" style="transform: rotate('+this.escapeExpression(this.lambda(null!=(n=null!=t?t.selected:t)?n.pressureDirection:n,t))+'deg)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 73.168 73.168"><path d="M58.079 22.316L40.682 1.633A4.581 4.581 0 0 0 37.249 0c-1.392.075-2.599.534-3.485 1.52L15.185 22.204a4.584 4.584 0 0 0 .35 6.468 4.583 4.583 0 0 0 6.472-.354l10.109-11.253v51.531a4.578 4.578 0 0 0 4.584 4.572 4.577 4.577 0 0 0 4.581-4.572v-52.02l9.785 11.63a4.554 4.554 0 0 0 3.509 1.632 4.591 4.591 0 0 0 2.945-1.068 4.58 4.58 0 0 0 .559-6.454z"/></svg>'},43:function(t,e,a,i){return"show"},45:function(t,e,a,i){var n,o=e.helperMissing,s="function",l=this.escapeExpression;return'\t\t\t<div class="weather-forecast-item weather-forecast-day" data-day="'+l(typeof(n=null!=(n=e.day||(null!=t?t.day:t))?n:o)==s?n.call(t,{name:"day",hash:{},data:i}):n)+'" data-test="forecast-day" title="'+l(typeof(n=null!=(n=e.condition||(null!=t?t.condition:t))?n:o)==s?n.call(t,{name:"condition",hash:{},data:i}):n)+'">\n\t\t\t\t<div class="weather-forecast-label" data-test="forecast-day-label">'+l(typeof(n=null!=(n=e.dayShort||(null!=t?t.dayShort:t))?n:o)==s?n.call(t,{name:"dayShort",hash:{},data:i}):n)+'</div>\n\t\t\t\t<span class="icon icon-weather weather-forecast-icon" data-icon="'+l(typeof(n=null!=(n=e.icon||(null!=t?t.icon:t))?n:o)==s?n.call(t,{name:"icon",hash:{},data:i}):n)+'" ></span>\n\t\t\t\t<span class="weather-forecast-high" data-test="forecast-high">'+l(typeof(n=null!=(n=e.high||(null!=t?t.high:t))?n:o)==s?n.call(t,{name:"high",hash:{},data:i}):n)+'&deg;</span><span class="weather-forecast-low">'+l(typeof(n=null!=(n=e.low||(null!=t?t.low:t))?n:o)==s?n.call(t,{name:"low",hash:{},data:i}):n)+"&deg;</span>\n\t\t\t</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,a,i){var n,o,s=this.lambda,l=this.escapeExpression,r=e.helperMissing,c="function";return'\x3c!-- Metric --\x3e\n<div class="app-dash metric-item" title="'+l(s(null!=(n=null!=t?t.now:t)?n.condition:n,t))+'" data-test="app-dash">\n\t<div class="metric-stat">\n'+(null!=(n=e.if.call(t,null!=(n=null!=t?t.now:t)?n.icon:n,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?n:"")+'\t</div>\n\t<div class="location metric-label data" data-test="location" title="'+l(typeof(o=null!=(o=e.locationExact||(null!=t?t.locationExact:t))?o:r)==c?o.call(t,{name:"locationExact",hash:{},data:i}):o)+'">\n\t\t<span class="metric-label-name">'+(null!=(n=typeof(o=null!=(o=e.brokenLocation||(null!=t?t.brokenLocation:t))?o:r)==c?o.call(t,{name:"brokenLocation",hash:{},data:i}):o)?n:"")+'</span>\n\t</div>\n\t<span class="metric-message">'+l(typeof(o=null!=(o=e.message||(null!=t?t.message:t))?o:r)==c?o.call(t,{name:"message",hash:{},data:i}):o)+'</span>\n</div>\n\n<div class="app-wrapper nipple nipple-top-right">\n\t<div class="app weather-app '+(null!=(n=e.if.call(t,null!=t?t.plusDetails:t,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?n:"")+'">\n\n\t\t\x3c!-- Main weather area --\x3e\n\t\t<section class="weather-current">\n\n\t\t\t\x3c!-- Header --\x3e\n\t\t\t<header class="weather-current-header">\n\n\t\t\t\t<div class="weather-current-location '+(null!=(n=e.if.call(t,null!=t?t.loading:t,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?n:"")+'">\n\t\t\t\t\t<div class="weather-location">\n\t\t\t\t\t\t<span class="weather-location-name" title="'+l(typeof(o=null!=(o=e.locationExact||(null!=t?t.locationExact:t))?o:r)==c?o.call(t,{name:"locationExact",hash:{},data:i}):o)+'" data-test="location-name">'+l(typeof(o=null!=(o=e.location||(null!=t?t.location:t))?o:r)==c?o.call(t,{name:"location",hash:{},data:i}):o)+"</span>\n"+(null!=(n=e.unless.call(t,null!=t?t.today:t,{name:"unless",hash:{},fn:this.program(9,i,0),inverse:this.noop,data:i}))?n:"")+(null!=(n=e.if.call(t,null!=t?t.message:t,{name:"if",hash:{},fn:this.program(11,i,0),inverse:this.noop,data:i}))?n:"")+'\t\t\t\t\t\t<i class="loading-icon"></i>\n\t\t\t\t\t\t<span class="weather-location-icon weather-location-edit" data-test="edit-icon"><i class="icon-edit"></i></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="input-group current-location-group">\n\t\t\t\t\t\t<div class="input-wrapper">\n\t\t\t\t\t\t\t<input type="text" name="current-location" id="current-location" class="current-location" autocomplete="off" placeholder="Location" value="'+l(typeof(o=null!=(o=e.location||(null!=t?t.location:t))?o:r)==c?o.call(t,{name:"location",hash:{},data:i}):o)+'" spellcheck="false" data-test="weather-location-search">\n\t\t\t\t\t\t\t<span class="icon-row">\n\t\t\t\t\t\t\t\t<span class="weather-location-icon weather-location-reset" title="Use your current location">\n\t\t\t\t\t\t\t\t\t<svg class="weather-location-reset-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 937.4 937.4"><path d="M887.4,418.7H855.6A390,390,0,0,0,518.7,81.8V50a50,50,0,0,0-100,0V81.8A390,390,0,0,0,81.8,418.7H50a50,50,0,0,0,0,100H81.8A390,390,0,0,0,418.7,855.6v31.8a50,50,0,0,0,100,0V855.6A390,390,0,0,0,855.6,518.7h31.8a50,50,0,0,0,0-100ZM730,518.7h24.4A290.53,290.53,0,0,1,518.6,754.5V730.1a50,50,0,0,0-100,0v24.4A290.53,290.53,0,0,1,182.8,518.7h24.4a50,50,0,0,0,0-100H182.8A290.53,290.53,0,0,1,418.6,182.9v24.4a50,50,0,1,0,100,0V182.9A290.53,290.53,0,0,1,754.4,418.7H730a50,50,0,1,0,0,100Z"/></svg>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<i class="u--flex-center clear" data-test="clear-icon">\n\t\t\t\t\t\t\t\t\t<span class="icon-wrapper">\n\t\t\t\t\t\t\t\t\t\t'+(null!=(n=typeof(o=null!=(o=e.iconCancel||(null!=t?t.iconCancel:t))?o:r)==c?o.call(t,{name:"iconCancel",hash:{},data:i}):o)?n:"")+'</span>\n\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="dropdown typeahead">\n\t\t\t\t\t\t\t<div class="searching">Searching<i>.</i><i>.</i><i>.</i></div>\n\t\t\t\t\t\t\t<ul class="dropdown-list location-dropdown-list" data-test="weather-location-results"></ul>\n\t\t\t\t\t\t\t<div class="not-found">No locations found.</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<span class="weather-current-conditions">'+l(s(null!=(n=null!=t?t.selected:t)?n.condition:n,t))+'</span>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="more">\n\t\t\t\t\t<div class="icon-wrapper more-toggle" data-test="more">\n\t\t\t\t\t\t'+(null!=(n=(e.iconEllipsis||t&&t.iconEllipsis||r).call(t,"more-icon",{name:"iconEllipsis",hash:{},data:i}))?n:"")+'</div>\n\t\t\t\t\t<div class="dropdown more-dropdown">\n\t\t\t\t\t\t<ul class="dropdown-list">\n\t\t\t\t\t\t\t<li class="toggle-hourly has-toggle" data-test="toggle-hourly-button">\n\t\t\t\t\t\t\t\tHourly forecast\n\t\t\t\t\t\t\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="toggle-details has-toggle" data-test="toggle-details-button">\n\t\t\t\t\t\t\t\tExtra weather info\n\t\t\t\t\t\t\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="line"></li>\n\t\t\t\t\t\t\t<li class="toggle-metric has-toggle" data-test="toggle-metrics-button">\n\t\t\t\t\t\t\t\tMetric units\n\t\t\t\t\t\t\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="weather-location-edit-menu" data-test="edit-dropdown">Edit location</li>\n'+(null!=(n=e.if.call(t,null!=t?t.plusDetails:t,{name:"if",hash:{},fn:this.program(13,i,0),inverse:this.noop,data:i}))?n:"")+'\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</header>\n\n\n\t\t\t<div class="weather-current-temp-row">\n\t\t\t\t\x3c!-- Main temp --\x3e\n\t\t\t\t<div class="weather-current-temp-wrapper toggle-hourly" data-test="toggle-hourly-div">\n\t\t\t\t\t'+(null!=(n=e.if.call(t,null!=t?t.plusDetails:t,{name:"if",hash:{},fn:this.program(15,i,0),inverse:this.noop,data:i}))?n:"")+'\n\t\t\t\t\t<span class="icon icon-weather weather-current-icon" data-icon="'+l(s(null!=(n=null!=t?t.selected:t)?n.icon:n,t))+'" title="'+l(s(null!=(n=null!=t?t.selected:t)?n.condition:n,t))+'"></span>'+(null!=(n=e.if.call(t,null!=t?t.today:t,{name:"if",hash:{},fn:this.program(18,i,0),inverse:this.program(20,i,0),data:i}))?n:"")+"\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- Main details --\x3e\n"+(null!=(n=e.if.call(t,null!=t?t.plusDetails:t,{name:"if",hash:{},fn:this.program(22,i,0),inverse:this.noop,data:i}))?n:"")+"\t\t\t</div>\n\n\n\t\t\t\x3c!-- Extra weather info --\x3e\n"+(null!=(n=e.if.call(t,null!=t?t.plusDetails:t,{name:"if",hash:{},fn:this.program(34,i,0),inverse:this.noop,data:i}))?n:"")+'\t\t</section>\n\n\n\n\t\t\x3c!-- 5-day advance forecast --\x3e\n\t\t<section class="weather-row weather-forecast weather-forecast-daily active">\n'+(null!=(n=e.each.call(t,null!=t?t.days:t,{name:"each",hash:{},fn:this.program(45,i,0),inverse:this.noop,data:i}))?n:"")+'\t\t</section>\n\n\t\t<div class="weather-empty empty">\n\t\t\t<div class="title">No location set</div>\n\t\t\t<button class="button find-location">\n\t\t\t\t<svg class="weather-location-reset-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 937.4 937.4"><path d="M887.4,418.7H855.6A390,390,0,0,0,518.7,81.8V50a50,50,0,0,0-100,0V81.8A390,390,0,0,0,81.8,418.7H50a50,50,0,0,0,0,100H81.8A390,390,0,0,0,418.7,855.6v31.8a50,50,0,0,0,100,0V855.6A390,390,0,0,0,855.6,518.7h31.8a50,50,0,0,0,0-100ZM730,518.7h24.4A290.53,290.53,0,0,1,518.6,754.5V730.1a50,50,0,0,0-100,0v24.4A290.53,290.53,0,0,1,182.8,518.7h24.4a50,50,0,0,0,0-100H182.8A290.53,290.53,0,0,1,418.6,182.9v24.4a50,50,0,1,0,100,0V182.9A290.53,290.53,0,0,1,754.4,418.7H730a50,50,0,1,0,0,100Z"/></svg>\n\t\t\t\t<span>Find My Location</span>\n\t\t\t</button>\n\t\t\t<div class="description set-manual-location" data-test="manual-location">Enter location manually</div>\n\t\t</div>\n\t\t<div class="weather-backround-icon">\n\t\t\t<div>H</div>\n\t\t</div>\n\n\n\t</div>\n</div>\n'},useData:!0}),L.styles=L.styles||{},L.styles.style=function(){var t=document.createElement("style");t.type="text/css",t.innerHTML='.weather{order:0}.weather .app-dash{cursor:pointer;order:1}.weather .location{outline:0}.weather .unit{display:block;position:absolute;left:97%;top:5px;animation:fadeout 4s ease 4s 1 normal;animation-fill-mode:forwards;font-size:55%;text-transform:uppercase}.weather .unit.hide,.weather.no-location .metric-stat .weather-degree{display:none}.weather .metric-stat .icon-weather{margin-right:6px}.weather.no-location .metric-stat .icon-weather{margin-right:0}.weather .icon:before{font-family:MeteoconsRegular;content:attr(data-icon)}@font-face{font-family:MeteoconsRegular;src:url(../font/meteocons.woff2) format("woff2");font-weight:400;font-style:normal}.weather .app{width:440px;padding-bottom:calc(var(--app-padding) - 3px);right:7px;box-sizing:border-box}.weather.no-location .app{min-height:230px}.weather.no-location:not(.setting-location) .app{display:flex;flex-direction:column;justify-content:center;align-items:center}.weather .icon-angle-down{position:absolute;top:10px;right:8px;font-size:14px;opacity:0}.weather .active .icon-angle-down{transform:rotate(180deg)}.weather .weather-empty{padding:0;display:none}.weather.no-location:not(.setting-location) .weather-empty{display:flex;flex-direction:column;align-items:center}.weather-empty .title{margin-bottom:10px}.weather-empty .button{display:flex;justify-content:space-between;align-items:center}.weather-empty .button .weather-location-reset-icon{margin-right:6px}.weather-empty .set-manual-location{padding:10px;margin:0;cursor:pointer}.weather-empty .set-manual-location:hover{opacity:.6}.weather .weather-backround-icon{width:100%;position:relative;display:none;color:rgba(255,255,255,.1);font-family:MeteoconsRegular;font-size:110px;align-items:center;justify-content:center}.light .weather .weather-backround-icon{color:rgba(0,0,0,.1)}.weather.setting-location .weather-backround-icon{display:block}.weather .weather-backround-icon>div{padding:20px;position:absolute;top:0;right:0;left:0;text-align:center}.weather-current{padding-top:0!important}.weather-current-header{margin:-3px 0 0;position:relative;display:flex;justify-content:space-between}.weather.no-location:not(.setting-location) .weather-current-header{display:none}.weather-current-location{min-width:0;display:inline-block;flex:0 1 auto}.weather .weather-location{display:flex;align-items:center;transition:opacity .2s}.weather.editing .weather-location{opacity:0}.weather-location-name{min-height:24px;min-width:32px;max-width:310px;margin-right:5px;display:inline;flex:0 1 auto;align-self:baseline;cursor:pointer;font-size:118.75%;outline:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.weather-header-message{margin:0 5px;align-self:baseline;opacity:.5}.weather-current-location .loading-icon{margin-left:6px;display:none;vertical-align:0}.weather-current-location.loading .loading-icon{display:inline-block}.weather-location-icon{padding:3px;cursor:pointer;opacity:0}.weather-current-location:not(.loading) .weather-location-icon:hover{opacity:1}.weather-location-edit{font-size:13px}.weather-location-edit .icon-edit{vertical-align:5%}.weather-current-location:hover .weather-location-edit{opacity:.5}.editing .weather-location-edit{visibility:hidden}.weather .current-location-group{position:absolute;top:-6px;left:0;right:0;z-index:-1;opacity:0;transition:.2s opacity}.weather.editing .current-location-group{z-index:1;opacity:1}.weather .icon-row{position:absolute;top:3px;right:0;display:flex;align-items:center}.weather .weather-location-reset{display:inline-block;opacity:.5}.weather .current-location-group .weather-location-reset:hover,.weather.editing .clear:active,.weather.editing .clear:hover{opacity:.7}.weather .app .weather-location-reset-icon{height:15px;fill:var(--icon-color);vertical-align:-10%}.f--quirky .weather .app .weather-location-reset-icon{vertical-align:-14%}.weather .current-location-group .input-wrapper{position:relative}.weather .current-location{font-size:19px;padding-right:40px}.weather .clear{padding:0 5px;bottom:0;cursor:pointer;font-size:1rem}.weather .clear .icon-wrapper:after{height:22px;width:22px}.weather .typeahead .location-dropdown-list{display:none;max-height:140px;overflow-x:hidden;overflow-y:auto}.weather .search-loading .typeahead .location-dropdown-list{padding:0}.weather .typeahead .location-result{margin-right:2px}.weather .searching{padding:4px 7px;display:none;font-size:87.5%;opacity:.6}.weather.search-loading .searching{display:block}.weather .searching i{animation:blink 1.4s infinite both}@keyframes blink{0%,100%{opacity:.2}20%{opacity:1}}.weather .searching i:nth-child(2){animation-delay:.2s}.weather .searching i:nth-child(3){animation-delay:.4s}.weather.search-loading .typeahead{padding:4px 0}.weather.search-loading .not-found{display:none}.weather-current-conditions{margin:-1px 0 10px;display:block;line-height:125%;opacity:.7}.weather-current-temp-row{margin-bottom:8px;display:flex;transition:filter .2s}.plus-weather .weather-current-temp-row{cursor:pointer}.weather.no-location .weather-current-temp-row{display:none}.weather-current-temp-wrapper{padding-right:22px;position:relative;flex:1 1 50%;box-sizing:border-box;white-space:nowrap}.f--startup .weather-current-temp-wrapper{padding-top:10px}.weather-current-details:hover .icon-angle-down,.weather-current-temp-wrapper:hover .icon-angle-down{opacity:.5}.weather-current-icon{margin-right:10px;font-size:58px;line-height:58px}.weather-current-temp{font-size:60px}.weather-current-temp-low{margin-left:2px;font-size:37.2px;opacity:.6}.weather-current-degree{margin-left:2px;font-size:42px;line-height:60px;opacity:1;vertical-align:top}.weather-current-details{height:70px;min-width:130px;margin:0;padding-top:4px;display:flex;flex-direction:column;justify-content:center;position:relative;flex:1 1 50%;box-sizing:border-box;font-size:13px;line-height:135%;transition:opacity .2s ease}.f--startup .weather-current-details{padding-top:25px}.weather-current-details .icon-angle-down{right:0}.weather-current-details-title{margin-right:1px;opacity:.6}.weather-current-details-value{opacity:.9}.weather-current-details-value-low{margin-left:4px;font-size:11px;line-height:100%;opacity:.6}.weather-arrow{height:12px;width:12px;margin-bottom:-1px;margin-left:2px;fill:var(--icon-color);transform:rotate(90deg)}.weather-optional{height:0;opacity:0;overflow:hidden;transition:all .2s ease}.weather-optional.active{opacity:1}.weather-row{border-top:1px solid var(--border-color);transition:all .2s}.weather.no-location .weather-row{display:none}.pending .weather-current-temp-row,.pending .weather-row{opacity:.2!important}.pending .weather-current-conditions{opacity:0!important}.weather-forecast{display:flex;font-size:11px}.weather-forecast-item{flex:1 1 11%;text-align:center}.weather-forecast-label{margin-top:1px;opacity:.6;font-size:10px;font-weight:500;line-height:1;text-transform:uppercase}.weather-forecast-icon{font-size:19px}.weather-forecast-high{opacity:.85}.weather-hourly{display:flex;align-items:center}.weather-forecast-hourly{flex-grow:1}.weather-forecast-hourly .weather-forecast-label{margin-bottom:6px}.weather-forecast-hourly .weather-forecast-high{margin-top:4px;line-height:1}.weather-optional.weather-hourly.active{height:75px}.f--startup .weather-optional.weather-hourly.active{height:79px}.weather-forecast-daily{padding-top:8px!important;clear:both;opacity:0;transition:opacity .2s ease}.weather-forecast-daily.active{opacity:1}.weather-forecast-day{margin:0 1.5px;padding:5px 2px;border-radius:3px;cursor:pointer;white-space:nowrap}.weather-forecast-day:first-child{margin-left:0}.weather-forecast-day:last-child{margin-right:0}.weather-forecast-day.selected,.weather-forecast-day:hover{background:rgba(255,255,255,.09)}.light .weather-forecast-day.selected,.light .weather-forecast-day:hover{background:rgba(0,0,0,.05)}.weather-forecast-daily .weather-forecast-label{margin-bottom:3px}.weather-forecast-daily .weather-forecast-icon{margin-bottom:0;margin-right:1px;display:inline-block;font-size:17px}.weather-forecast-daily .weather-forecast-high{padding-right:0}.weather-forecast-daily .weather-forecast-low{padding-left:3px;opacity:.4}.weather-extra{padding:11px 0;display:flex;font-size:12px}.weather-optional.weather-detail.active{height:90px}.weather-extra-col{flex:1 1 50%}.weather-extra-cell{line-height:135%}.weather-extra-cell:nth-child(odd){margin-bottom:4px}.weather-arrow-pressure{height:9px;width:9px;margin-bottom:0;margin-left:-2px;padding-right:2px}.weather-detail-unavailable{padding:11px 0;display:none;font-size:13px;text-align:center}.weather-detail-unavailable.show{display:block}.weather.editing .more-toggle,.weather.no-location .more{display:none}.weather-detail-unavailable>span{opacity:.5}.weather .more{position:static;margin:calc(-1 * var(--app-padding)) calc(-1 * var(--app-padding)) 0 0;padding:var(--app-padding);cursor:pointer}.weather .more-toggle{padding-top:2px}.weather .more-dropdown{top:35px;right:0}.weather .weather-attribution{padding-top:5px;padding-bottom:2px;cursor:default;font-size:10px;opacity:.5}.weather .weather-attribution:hover{background:0 0!important}.weather-attribution-logo{height:10px}.light .weather-attribution-logo{filter:brightness(13%)}',document.getElementsByTagName("head")[0].appendChild(t)},L.views.Weather=Backbone.View.extend({attributes:{id:"weather",class:"no-location"},template:L.templates.weather,events:{"paste .weather-location-name":"handlePaste","dblclick .weather-current-location":"editLocation","mousedown .weather-location-reset":"resetLocation","click .weather-empty .find-location":"resetLocation","click .weather-empty .set-manual-location":"showLocationChooser","click .weather-location-edit":"editLocation","click .weather-location-edit-menu":"editLocation","click .ready-to-set":"setLocation","click .app-dash":"togglePopup","click .weather-forecast-day":"switchDay","click .toggle-details":"toggleDetails","click .toggle-hourly":"toggleHourly","click .toggle-metric":"toggleUnit","webkitAnimationEnd .weather-current-location":"onAnimationEnd","click .more":"toggleMore","click .current-location-group .clear":"cancelSearch","mousedown .location-dropdown-list li":"chooseLocation","click .current-location":"showDropdown","keyup .current-location":"checkSearch","blur .current-location":"cancelSearch","keydown .current-location":"preventDefaultAction","mouseover .dropdown-list li":"updateHover"},initialize:function(){var e=this;this.loadingMessage="Finding Location…",this.today=!0,this.setBaseCodes(),this.loadingSearch=0,this.renderedOnce=!1,this.detailVisible=!1,this.hourlyVisible=!1,this.maxCharPerLine=16,this.listenTo(b.models.customization,"change:hour12clock",this.render),this.listenTo(b.models.customization,"change:temperatureUnit",this.render),this.listenTo(b.models.customization,"change:weatherDetail",this.updateDetails),this.listenTo(b.models.customization,"change:weatherHourly",this.updateHourly),this.listenTo(this.model,"change:error",this.renderIfVisible),this.listenTo(this.model,"change:now",this.renderIfVisible),this.listenTo(this.model,"change:hours",this.renderIfVisible),this.listenTo(this.model,"change:loading",this.setLoading),this.listenTo(b,"globalEvent:key:W",this.togglePopup),this.options.unitClass="hide",this.listenTo(b.models.customization,"change:weatherVisible",this.visibleChanged),this.listenTo(this.model,"change:location",function(){var t=e.model.get("location");t&&t.countryCode&&e.setUnit(t.countryCode),e.$el.removeClass("no-location setting-location")}),this.listenTo(b,"globalEvent:esc globalEvent:click",this.hide),this.render()},handlePaste:function(t){t.preventDefault(),i(t.currentTarget).html("")},updateDetails:function(){if(!this.updatingState){this.updatingState=!0;var t=this,e=this.detailVisible,a=!0===b.models.customization.get("weatherDetail")&&void 0!==this.model.get("hours")&&b.conditionalFeatures.featureEnabled("plus");e=!0===b.models.customization.get("weatherDetail")&&void 0!==this.model.get("hours")&&b.conditionalFeatures.featureEnabled("plus")&&this.today;var i=(b.models.customization.get("weatherDetail")||b.models.customization.get("weatherHourly"))&&!this.today&&b.conditionalFeatures.featureEnabled("plus");t.$el.find(".weather-detail").toggleClass("active",e),t.$el.find(".toggle-details").toggleClass("on",a),t.$el.find(".weather-current-details").toggleClass("active",e),t.$el.find(".weather-detail-unavailable").toggleClass("show",i),t.detailVisible=e,t.updatingState=!1}},updateHourly:function(){if(!this.updatingState){this.updatingState=!0;var t=this,e=this.hourlyVisible,a=!0===b.models.customization.get("weatherHourly")&&void 0!==this.model.get("hours")&&b.conditionalFeatures.featureEnabled("plus");e=!0===b.models.customization.get("weatherHourly")&&void 0!==this.model.get("hours")&&b.conditionalFeatures.featureEnabled("plus")&&this.today;var i=(b.models.customization.get("weatherDetail")||b.models.customization.get("weatherHourly"))&&!this.today&&b.conditionalFeatures.featureEnabled("plus");t.$el.find(".weather-hourly").toggleClass("active",e),t.$el.find(".toggle-hourly").toggleClass("on",a),t.$el.find(".weather-current-temp-wrapper").toggleClass("active",e),t.$el.find(".weather-detail-unavailable").toggleClass("show",i),t.hourlyVisible=e,t.updatingState=!1}},setBaseCodes:function(){var t=this.baseCodes={};t.tornado="F",t.tropicalStorm="F",t.hurricane="F",t.severeThunderstorm="O",t.thunderstorm="P",t.mixedRainAndSnow="X",t.drizzle="Q",t.rain="R",t.freezingRain="X",t.showers="Q",t.sunnyShowers="Q",t.snowFlurries="U",t.snow="W",t.hail="X",t.sleet="X",t.dust="J",t.foggy="M",t.haze="J",t.smoky="M",t.blustery="F",t.windy="F",t.cold="G",t.cloudy="Y",t.mostlyCloudyNight="I",t.mostlyCloudyDay="H",t.partlyCloudyNight="E",t.partlyCloudyDay="H",t.clearNight="C",t.clearDay="B",t.scatteredThunderstorm="O",t.scatteredShowers="Q",t.heavySnow="W",t.thundershowers="O",t.snowShowers="W",t.unknown=")"},show:function(){this.$el.find(".toggle-metric").toggleClass("on","c"===this.displayUnit()),this.$el.find(".weather-forecast-day[data-day='"+this.selectedDayName+"']").first().addClass("selected"),this.model.updateWeather(!0),this.$el.addClass("show"),this.updateDetails(),this.updateHourly(),this.open=!0;var t=this;b.widgetManager.unfocusOverlap(this.options.region,this.$app.height()),setTimeout(function(){t.$el.addClass("show-fade-in")},5)},hide:function(t){if(!(0<this.$el.find(".upsell-overlay.active").length)&&this.open)if(t&&27===t.keyCode&&this.isEditing())this.cancelSearch();else{var e=this.$el.find(".more")[0];if(t&&(i.contains(e,t.target)||e===t.target)||this.dropdownOpen&&this.toggleMore(),!t||!i.contains(this.$el[0],t.target)){this.$el.removeClass("show-fade-in"),this.open=!1;var a=this;b.widgetManager.refocusOverlap(this.options.region),setTimeout(function(){a.$el.removeClass("show")},250),this.dropdownOpen&&this.toggleMore()}}},togglePopup:function(){this.$el.hasClass("show")?this.hide():this.show()},toggleDetails:function(t){if(!this.isEditing())if(t&&t.stopPropagation(),b.conditionalFeatures.featureEnabled("plus"))b.models.customization.save("weatherDetail",!b.models.customization.get("weatherDetail"));else{b.commandManager.execute("upsell.message",{targetRegion:"weather",sourceEvent:"weather-detail",buttonText:"Learn more",title:"Weather Details",description:"Wind, rain, hourly forecast, more accurate feed, and more!"})}},toggleHourly:function(t){if(!this.isEditing())if(t&&t.stopPropagation(),b.conditionalFeatures.featureEnabled("plus"))b.models.customization.save("weatherHourly",!b.models.customization.get("weatherHourly"));else{if(i(t.currentTarget).hasClass("weather-current-temp-wrapper"))return;b.commandManager.execute("upsell.message",{targetRegion:"weather",sourceEvent:"weather-hourly",buttonText:"Learn more",title:"Hourly Forecast",description:"See the hour-by-hour forecast for the day"})}},switchDay:function(t){if(!this.isEditing()){t.stopPropagation(),this.$el.find(".weather-forecast-day").removeClass("selected");var e=t.currentTarget.dataset.day;if(e!==this.selectedDayName)this.selectedDayName=e,this.today=this.model.get("days")[0].day===e,this.daySelectionActive=!0,i(t.currentTarget).addClass("selected"),this.render()}},render:function(){if(this.loadTriggered||(b.widgetManager.appReady(L.info.id),this.loadTriggered=!0),!this.$location||!this.isEditing()){var t="Set Location",e=this.model.get("location")&&this.model.get("location").locationName,a=this.model.get("location")&&this.model.get("location").locationExact,h=this;e&&0!==e.length||this.model.get("loading")||(e=t,this.$el.addClass("no-location"));var i,n,o,s,l,r=[],c=[],d=this.model;this.today&&(o=d.get("now")),d.get("days")&&(this.selectedDayName||(this.selectedDayName=d.get("days")[0].day,this.today=!0),this.today?this.selectedDayName=d.get("days")[0].day:s=this.selectedDayName,d.get("days").forEach(function(t){o||t.day!==h.selectedDayName||(o=t),r.push({high:h.calculateDisplayTemperature(t.high),low:h.calculateDisplayTemperature(t.low),condition:b.utils.capitalizeFirstLetter(t.condition),icon:h.getIconFromCode(t.code,d.get("provider")),unitClass:h.options.unitClass,dayShort:t.day.substr(0,3),day:t.day})})),d.get("hours")&&d.get("hours").forEach(function(t){l=x(t);var e=t.hour.substr(t.hour.indexOf("T")+1,2);c.push({temperature:h.calculateDisplayTemperature(t.temperature),condition:b.utils.capitalizeFirstLetter(t.condition),icon:h.getIconFromCode(t.code,d.get("provider")),unitClass:h.options.unitClass,hour:b.models.customization.get("hour12clock")?h.convertTo12H(parseInt(e)):e,precipChance:l.chance,precipType:l.type,windSpeed:h.calculateDisplaySpeed(t.windSpeed),windGust:h.calculateDisplaySpeed(t.windGust)})});var u,p=this.model.get("now");if(p){l=x(p);var g=p.sunset?p.sunset.substr(p.sunset.indexOf("T")+1,5):null,w=p.sunrise?p.sunrise.substr(p.sunrise.indexOf("T")+1,5):null,m=b.models.customization.get("hour12clock"),f=0,v=!0;"Falling"===p.pressureTendency?f=180:"Steady"===p.pressureTendency&&(v=!1);var y=h.getIconFromCode(p.code,d.get("provider"))||"H";n={condition:b.utils.capitalizeFirstLetter(p.condition),cloudCover:p.cloudCover,windDirection:p.windDirection+180,windSpeed:h.calculateDisplaySpeed(p.windSpeed),windGust:h.calculateDisplaySpeed(p.windGust),temperature:h.calculateDisplayTemperature(d.get("now").temperature),apparentHigh:h.calculateDisplayTemperature(p.apparentHigh),apparentLow:h.calculateDisplayTemperature(p.apparentLow),apparentTemperature:h.calculateDisplayTemperature(p.apparentTemperature),uvIndex:p.uvIndex,uvIndexText:p.uvIndexText,icon:y,humidity:p.humidity,dewPoint:h.calculateDisplayTemperature(p.dewPoint),pressure:h.calculateDisplayPressure(p.pressure),pressureTendency:p.pressureTendency,pressureDirection:f,pressureDirectionVisible:v,high:h.calculateDisplayTemperature(p.high),low:h.calculateDisplayTemperature(p.low),sunset:g?m?h.convertTo12H(g.substr(0,2),g.substr(3,2)):g:null,sunrise:w?m?h.convertTo12H(w.substr(0,2),w.substr(3,2)):w:null,moonPhase:p.moonPhase,precipChance:l.chance,precipType:l.type,precipAmount:h.calculateDisplayLength(p.precipAmount),visibility:h.calculateDisplayLongLength(p.visibility),visibilityText:p.visibilityText,precipitationExpected:h.calculateDisplayLength(o.precipitationExpected),hoursOfSun:Math.round(p.hoursOfSun)}}return o===p?u=n:o&&(l=x(o),u={condition:b.utils.capitalizeFirstLetter(o.condition),cloudCover:o.cloudCover,windDirection:o.windDirection+180,windSpeed:h.calculateDisplaySpeed(o.windSpeed),windGust:h.calculateDisplaySpeed(o.windGust),temperature:h.calculateDisplayTemperature(d.get("now").temperature),apparentHigh:h.calculateDisplayTemperature(o.apparentHigh),apparentLow:h.calculateDisplayTemperature(o.apparentLow),apparentTemperature:h.calculateDisplayTemperature(o.apparentTemperature),uvIndex:o.uvIndex,uvIndexText:o.uvIndexText,icon:h.getIconFromCode(o.code,d.get("provider")),humidity:o.humidity,dewPoint:h.calculateDisplayTemperature(o.dewPoint),pressure:h.calculateDisplayPressure(o.pressure),pressureTendency:o.pressureTendency,pressureDirection:f,pressureDirectionVisible:v,high:h.calculateDisplayTemperature(o.high),low:h.calculateDisplayTemperature(o.low),precipChance:l.chance,precipType:l.type,precipAmount:h.calculateDisplayLength(o.precipAmount),visibility:h.calculateDisplayLongLength(o.visibility),visibilityText:o.visibilityText,precipitationExpected:h.calculateDisplayLength(o.precipitationExpected),hoursOfSun:Math.round(o.hoursOfSun)}),i={location:e,brokenLocation:lineBreakString(e,this.maxCharPerLine),locationExact:a,unit:this.displayUnit(),now:n,selected:u,unitClass:this.options.unitClass,message:this.model.get("error"),days:r,hours:c,plusDetails:b.conditionalFeatures.featureEnabled("plus"),detailVisible:b.models.customization.get("weatherDetail")&&this.today&&b.conditionalFeatures.featureEnabled("plus"),hourlyVisible:b.models.customization.get("weatherHourly")&&this.today&&b.conditionalFeatures.featureEnabled("plus"),unavailableVisible:(b.models.customization.get("weatherDetail")||b.models.customization.get("weatherHourly"))&&!this.today&&b.conditionalFeatures.featureEnabled("plus"),loading:this.model.get("loading"),today:this.today,displayDay:s},this.$el.html(this.template(i)),this.$el.attr("data-test","weather"),this.renderedOnce?this.$el.removeClass("show show-fade-in"):b.appsLoaded&&this.$el.mFadeIn(),this.$location=this.$(".weather-location-name"),this.$location.toggleClass("ready-to-set",e===t),this.renderedOnce=!0,this.$app=this.$(".app"),this.open&&(this.$el.addClass("show show-fade-in"),b.widgetManager.unfocusOverlap(this.options.region,this.$app.height()),this.$el.find(".toggle-metric").toggleClass("on","c"===this.displayUnit()),this.daySelectionActive&&this.$el.find(".weather-forecast-day[data-day='"+this.selectedDayName+"']").first().addClass("selected"),this.updateDetails(),this.updateHourly()),this.dropdownOpen&&this.toggleMore(),this.$el.removeClass("pending"),this.$currentLocation=this.$(".current-location"),this.$currentLocationGroup=this.$(".current-location-group"),this.$typeAhead=this.$(".typeahead"),this.$notFound=this.$(".typeahead .not-found"),this.$dropdownList=this.$(".location-dropdown-list"),this}function x(t){var e=null==t.high?t.temperature:t.high,a=null==t.low?t.temperature:t.low,i=t.rainProbability,n=t.snowProbability,o=t.iceProbability,s=15<i,l=15<n,r=15<o,c="precip.",d=t.precipitationProbability;return s||l||r?!s||l||r?s||!l||r?s||l||!r||(c="ice",d=o):(c="snow",d=n):(d=i,c="rain"):h.calculateDisplayTemperature(e,!0)<0?(d=n,c="snow"):0<h.calculateDisplayTemperature(a,!0)&&(d=i,c="rain"),{type:c,chance:d}}},setLoading:function(){this.$el.find(".weather-current-location").toggleClass("loading",this.model.get("loading"))},convertTo12H:function(t,e){var a="AM",i=t=parseInt(t);return 12<=i&&(i=t-12,a="PM"),0===i&&(i=12),i+(void 0===e?"":":"+e)+a},visibleChanged:function(){b.models.customization.get("weatherVisible")?this.renderedOnce?this.$el.mFadeIn():this.render():this.$el.mFadeOut()},calculateDisplayTemperature:function(t,e){var a=this.model.get("fetchUnit"),i=t;return i||0===i?"c"===this.displayUnit()||e?"c"===a?i:Math.round(5*(i-32)/9):"c"===a?Math.round(9*i/5+32):i:null},calculateDisplaySpeed:function(t){var e=this.model.get("fetchUnit");return t||0===t?"mph"===this.displaySpeedUnit()?("c"===e?Math.round(.62137*t):Math.round(t))+" mph":("c"===e?Math.round(t):Math.round(1.60934*t))+" km/h":null},calculateDisplayPressure:function(t){var e=this.model.get("fetchUnit");return t||0===t?"inHg"===this.displayPressureUnit()?("c"===e?Math.round(.02953*t):t)+" inHg":("c"===e?Math.round(t):Math.round(33.8639*t))+" hPa":null},calculateDisplayLength:function(t){var e=this.model.get("fetchUnit");return t||0===t?"in"===this.displayLengthUnit()?("c"===e?Math.round(.03937*t):t)+" in":("c"===e?Math.round(t):Math.round(25.4*t))+"mm":null},calculateDisplayLongLength:function(t){var e=this.model.get("fetchUnit");return t||0===t?"in"===this.displayLengthUnit()?("c"===e?Math.round(.62137*t):Math.round(t))+" mi":("c"===e?Math.round(t):Math.round(1.60934*t))+" km":null},displayPressureUnit:function(){return"f"===this.displayUnit()?"inHg":"kPa"},displaySpeedUnit:function(){return"f"===this.displayUnit()?"mph":"km/h"},displayLengthUnit:function(){return"f"===this.displayUnit()?"in":"mm"},displayUnit:function(){var t=b.models.customization.get("temperatureUnit");return t||(this.defaultUnit?this.defaultUnit:"c")},isEditing:function(){return this.$el.hasClass("editing")},setLocation:function(){this.$location.html(""),this.editLocation()},editLocation:function(t){t&&t.stopPropagation();var e=this;this.dropdownOpen&&this.toggleMore(),this.isEditing()||(this.model.get("location")&&this.model.get("location").locationName||this.$currentLocation.val(""),this.$el.addClass("editing pending"),this.$currentLocation.trigger("focus"),setTimeout(function(){e.$currentLocation.select()},100),this.searchForLocation())},onAnimationEnd:function(t){"pulse"===t.originalEvent.animationName&&this.$location.removeClass("pulse")},resetLocation:function(t){t&&(t.preventDefault(),t.stopPropagation()),this.doneEditingLocation(),localStorage.removeItem("weather-manual"),this.model.set({error:null,firstLoad:!1}),this.model.set({location:null},{silent:!0}),this.model.trigger("change:location");var e=this;setTimeout(function(){e.$(".weather-location-name").html(e.loadingMessage)},50)},doneEditingLocation:function(){this.$el.removeClass("editing pending")},toggleUnit:function(t){t&&t.stopPropagation(),this.options.unitClass="","c"===this.displayUnit()?b.models.customization.save("temperatureUnit","f"):b.models.customization.save("temperatureUnit","c")},setUnit:function(t){this.defaultUnit=0<=["US","BM","BZ","JM","PW"].indexOf(t)?"f":"c"},getIconFromCode:function(t){return this.baseCodes[t]},toggleMore:function(){var t=this.$(".more");t.toggleClass("active"),this.dropdownOpen=t.hasClass("active")},renderIfVisible:function(){this.renderedOnce&&this.render()},showUpsell:function(t){this.upsellView&&this.upsellView.remove(),t.template=b.templates.upsell.appupsell,this.upsellView=new b.views.upsell.Message(t);var e=this.upsellView.render().$el;this.$el.find(".app").append(e),this.upsellView.show()},preventDefaultAction:function(t){38!==t.keyCode&&40!==t.keyCode||t.preventDefault()},cancelSearch:function(t){if(t&&(t.preventDefault(),t.stopPropagation()),this.isEditing()){this.$location.html(this.model.get("location").locationName),this.revertLocation(!0);var e=this;setTimeout(function(){e.doneEditingLocation()},100),this.$el.removeClass("setting-location")}},checkSearch:function(t){var e=this;if(t.keyCode===mConst("keyEscape"))this.revertLocation();else if(37!==t.keyCode&&39!==t.keyCode)if(9===t.keyCode&&t.shiftKey||16===t.keyCode)this.showDropdown();else if(t.keyCode===mConst("keyReturn")){if(!this.suggestionList||0===this.suggestionList.length)return void this.cancelSearch();this.chooseLocation()}else if(38===t.keyCode){if(!this.suggestionList||0===this.suggestionList.length)return;this.selected=0===this.selected?this.suggestionList.length-1:this.selected-1,this.hoverSelected()}else if(40===t.keyCode){if(!this.suggestionList||0===this.suggestionList.length)return;this.selected=this.selected===this.suggestionList.length-1?0:this.selected+1,this.hoverSelected()}else{var a=this.$currentLocation.val().trim().length;this.renderClearIcon();var i=b.date().getTime();this.triggeredSearchAt=i,2<a&&setTimeout(function(){i===e.triggeredSearchAt&&e.searchForLocation(),e.triggeredOnce=!0},e.triggeredOnce?300:0),a<3&&(this.$dropdownList.empty(),0===this.$dropdownList.val().trim.length&&this.closeDropdown())}},closeDropdown:function(){this.$dropdownList.hide(),this.$notFound.removeClass("active")},revertLocation:function(t){this.suggestionList=null,this.$currentLocation.val(this.model&&this.model.get("location")?this.model.get("location").locationName:""),t||this.$currentLocation.trigger("blur"),this.$dropdownList.empty(),this.closeDropdown()},searchForLocation:function(){var a=this,t=this.$currentLocation.val();if(0!==t.trim().length&&(this.lastQuery!==t||!this.suggestionList)){this.lastQuery=t;var e=b.globals.urlRootApi+"weather/search";this.loadingSearch++,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){a.$typeAhead.css("display","block"),a.$el.addClass("search-loading")},300),i.ajax({type:"GET",contentType:"application/json",beforeSend:setMomentumAuthHeader,url:e,data:{name:t.toLowerCase()}}).done(function(t){if(a.loadingSearch--,a.$notFound.removeClass("active"),t&&0===a.loadingSearch){a.suggestionList=t,a.$dropdownList.empty(),a.suggestionMap={};var e=0;if(0===a.suggestionList.length)return 0===a.loadingSearch&&a.$notFound.addClass("active"),a.$dropdownList.hide(),a.timeout&&clearTimeout(a.timeout),void a.$el.removeClass("search-loading");a.suggestionList.forEach(function(t){4<e||(a.suggestionMap[t.locationName]=t,a.$dropdownList.append('<li data-id="'+t.locationExact+'" data-index='+e+" data-offset="+t.currentOffset+'><span class="location-result">'+t.locationExact+"</span></li>"),e++)}),a.$dropdownList.css("display","block"),a.selected=0,a.hoverSelected(),a.$typeAhead.css("display","block"),a.timeout&&clearTimeout(a.timeout),a.$el.removeClass("search-loading")}}).fail(function(){a.loadingSearch--,a.timeout&&clearTimeout(a.timeout),a.$el.removeClass("search-loading")})}},hoverSelected:function(){this.hoverById(this.suggestionList[this.selected].locationExact)},hoverById:function(t){this.$dropdownList.find("li").removeClass("hover"),this.$dropdownList.find('li[data-id="'+t+'"]').addClass("hover")},chooseLocation:function(t){t&&t.stopPropagation(),this.selectedLocation=this.suggestionList[this.selected],this.$currentLocation.val(this.selectedLocation.locationName),this.$location.html(this.selectedLocation.locationName),this.$el.find(".error-message").hide(),this.closeDropdown(),this.model.set({loading:!1,error:null}),this.doneEditingLocation(),this.$el.addClass("pending");var e={locationId:null,locationName:this.selectedLocation.locationName,locationExact:this.selectedLocation.locationExact,countryCode:this.selectedLocation.countryCode,latitude:this.selectedLocation.latitude,longitude:this.selectedLocation.longitude,manual:!0};this.model.loadFromLocalStorage(),this.model.foundLocation(e,!0)},updateHover:function(t){var e=t.currentTarget.dataset,a=e.id;this.selected=Number.parseInt(e.index),this.hoverById(a)},renderClearIcon:function(){0<this.$currentLocation.val().trim().length?this.$currentLocationGroup.addClass("has-input"):this.$currentLocationGroup.removeClass("has-input")},showDropdown:function(){this.$dropdownList.find("li").length?(this.$dropdownList.css("display","block"),b.trigger("clock:resize")):this.searchForLocation()},showLocationChooser:function(){this.$el.addClass("setting-location"),this.editLocation()}}),L.models.Weather=Backbone.Model.extend({defaults:{location:{},now:{},fetchUnit:"c"},initialize:function(){var e=this;this.loadFromLocalStorage(),(this.get("firstLoad")||this.get("loading"))&&(this.set({firstLoad:!1,loading:!1}),this.store()),setInterval(function(){e.updateWeather()},6e5);var t=this.getSavedManualWeatherLocation();setInterval(function(){e.getSavedManualWeatherLocation()||e.updateCoords()},6e6),this.listenTo(b,"weather:reset",function(){e.set({updatedForecast:null,updated:null}),e.store()}),this.listenTo(this,"change:providerId",function(){e.store(),e.get("location").locationId=null,e.set({updatedForecast:null,updated:null}),e.store(),e.trigger("change:location")}),this.listenTo(this,"change:location",function(){var t=e.get("location");t&&t.countryCode&&localStorage.setItem("country",t.countryCode),e.updateWeather(!0)}),this.set("providerId",1),setTimeout(function(){e.updateWeather(),t||e.updateCoords()},100),window.addEventListener("focus",function(t){e.missedUpdate&&e.updateWeather()})},updateCoords:function(){var a=this;this.getCoordinates(function(t){if(t.changed){var e=a.get("location");(e=e||{}).latitude=t.latitude,e.longitude=t.longitude,e.locationId=null,e.manual=!1,a.set({updatedForecast:null,updated:null,error:null,location:e},{silent:!0}),a.store(),a.updateWeather(!0)}})},store:function(){localStorage.setItem("weather",JSON.stringify(this.attributes))},loadFromLocalStorage:function(){var t=localStorage.getItem("weather");t&&(this.attributes=JSON.parse(t))},updateWeather:function(a,t){if(this.missedUpdate=!document.hasFocus(),!this.missedUpdate){var i=this,n=b.date().getTime();if(this.get("location")&&this.get("location").latitude){if((!(a&&n-this.get("updatedForecast")<18e5)||t)&&(a||!(n-this.get("updated")<6e5)||t)){var e,o,s,l=this.get("location");if(e=a?"forecast":"current",this.url=b.globals.urlRoot+"weather/"+e+"?",l.locationId&&0<l.locationId.length)this.url+="locationId="+l.locationId;else{if(1==l.latitude&&1==l.longitude)return void this.updateCoords();this.url+="lat="+l.latitude+"&lon="+l.longitude}this.set("loading",!0),l&&l.locationName&&l.manual&&(o=l.locationName,s=l.locationExact),this.fetch({error:function(){i.set("loading",!1)},success:function(){if(l=i.get("location"),o&&(l.locationName=o,l.locationExact=s,l.manual=!0),a)i.set({loading:!1,updated:n,updatedForecast:n});else{var t=JSON.parse(JSON.stringify(i.attributes));i.loadFromLocalStorage();var e=i.get("now");e||i.set("now",i.defaults.now),Object.assign(e,t.now),Object.assign(i.get("location"),t.location),i.set({provider:t.provider,fetchUnit:t.fetchUnit,loading:!1,updated:n})}i.trigger("change:now"),i.trigger("change:loading"),i.store()}})}}else this.updateCoords()}},getManualLocation:function(t){var e=this;this.url=b.globals.urlRoot+"weather/location?location="+t,this.set("loading",!0),this.fetch({error:function(){e.set({loading:!1,error:t+" not found"}),setTimeout(function(){e.set({error:null})},5e3)},success:function(){e.set({loading:!1,error:null});var t=JSON.parse(JSON.stringify(e.attributes.location));e.loadFromLocalStorage(),e.foundLocation(t,!0)}})},foundLocation:function(t,e){e&&localStorage.setItem("weather-manual",JSON.stringify(t)),this.set({location:t,updated:null,updatedForecast:null,error:null,manual:1==e,firstLoad:1==e,loading:!1},{silent:!0}),this.updateWeather(!0,!0),this.store(),t.countryCode&&(localStorage.country=t.countryCode)},getSavedManualWeatherLocation:function(){var t=localStorage.getItem("weather-manual");return t?JSON.parse(t):null},getCoordinates:function(a){var i=this;function e(t){if(i.waitingForLocation){i.waitingForLocation=!1,i.set("loading",!1),i.trigger("change:loading"),t&&console.log("Error getting location: "+t.code+", msg: "+t.message);var e=i.getSavedManualWeatherLocation();e?a({latitude:e.latitude,longitude:e.longitude,changed:!1}):i.lastPosition&&(i.lastPosition.changed=n(i.lastPosition),a(i.lastPosition)),i.set("error","")}}function n(t){var e=!0,a=i.get("location");return a&&(+a.latitude).toFixed(2)==(+t.latitude).toFixed(2)&&(+a.longitude).toFixed(2)==(+t.longitude).toFixed(2)&&(e=!1),e}this.get("location")&&this.get("location").latitude||(this.set("loading",!0),this.trigger("change:loading")),this.waitingForLocation=!0,navigator.geolocation.getCurrentPosition(function(t){if(!t.coords)return;i.lastPosition={latitude:t.coords.latitude,longitude:t.coords.longitude,changed:n(t.coords)},i.waitingForLocation=!1,i.set("loading",!1),i.trigger("change:loading");try{a(i.lastPosition)}catch(t){console.log(t),e(t)}},e),setTimeout(function(){e()},8e3)}}),L.styles.style(),L.views.countdown=b.widgetManager.handover("weather",L.views.Weather,{model:new L.models.Weather,region:"top-right",order:"prepend"}),b.widgets.push(b.views.weather),L};m.addinManager&&m.addinManager.registerAddinFn("d5f1661a-8698-4992-b191-d0833b124f6a",fn_addin);
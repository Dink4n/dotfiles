var fn_addin=function(l,a,t){var c=c||{};return c.styles=c.styles||{},c.commands=c.commands||{},c.dependencies=t||c.dependencies||{},c.styles.style=function(){},c.views=c.views||{},c.collect=c.collect||{},c.models=c.models||{},c.templates=c.templates||{},c.info={id:"base_metric",addin:"ce945086-a64d-4b67-b730-9eb7d7b72030"},l.console.log(l.elapsed()+": "+c.info.id+" started"),c.templates=c.templates||{},c.templates.baseMetric=Handlebars.template({1:function(t,e,i,s){var n,a,l=e.helperMissing,r=this.escapeExpression,o="function";return'<div class="app-dash metric-dash metric-dash-empty add-shadow" title="Add a '+r((e.lower||t&&t.lower||l).call(t,null!=t?t.metricType:t,{name:"lower",hash:{},data:s}))+'">\n\t<div class="metric-item" data-test="metric-dash-empty">\n\t\t<div class="metric-stat">\n\t\t\t<span class="sets-height">+</span>\n\t\t\t<span class="absolute">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 533.33 533.33"><path d="M516.67,200H333.33V16.67A16.66,16.66,0,0,0,316.67,0h-100A16.67,16.67,0,0,0,200,16.67V200H16.67A16.67,16.67,0,0,0,0,216.67v100a16.66,16.66,0,0,0,16.67,16.66H200V516.67a16.66,16.66,0,0,0,16.67,16.66h100a16.66,16.66,0,0,0,16.66-16.66V333.33H516.67a16.66,16.66,0,0,0,16.66-16.66v-100A16.66,16.66,0,0,0,516.67,200Z"/></svg>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="metric-label">\n\t\t\t<span class="metric-label-name">'+r(typeof(a=null!=(a=e.metricType||(null!=t?t.metricType:t))?a:l)==o?a.call(t,{name:"metricType",hash:{},data:s}):a)+'</span>\n\t\t</div>\n\t</div>\n</div>\n\n<div class="app-dash metric-dash has-multiple add-shadow" data-test="metric-dash">\n</div>\n\n<div class="app-wrapper nipple nipple-top-right">\n\t<div class="app app-metric">\n\t\t<div class="subviews-wrapper">\n\t\t\t<div class="subviews">\x3c!--\n\t\t\t--\x3e<div class="subview metric-archive" data-test="metric-archive-panel">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 20"><g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M22.75 6.75l-1.204 9c0 1.657-1.93 3-3.588 3H7.99c-1.657 0-3.406-1.343-3.406-3l-1.334-9M22.75 1.25H3.25a1.5 1.5 0 0 0-1.5 1.5v3h22.5v-3a1.5 1.5 0 0 0-1.5-1.5z"/><path d="M16 10.85c0 1.16-.672 2.1-1.5 2.1h-3c-.828 0-1.5-.94-1.5-2.1 0-1.16.672-2.1 1.5-2.1h3c.828 0 1.5.94 1.5 2.1z"/></g></svg>\n\t\t\t\t\t<span class="title">Archive</span>\n\t\t\t\t\t<div class="controls">\n\t\t\t\t\t\t<span class="control icon-wrapper back"><i class="icon icon-right"></i></span>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<div class="body">\n\t\t\t\t\t<div class="message hidden">\n\t\t\t\t\t\t<span class="loading hidden"><span class="loading-placeholder"></span><span class="loading-label">Loading...</span></span>\n\t\t\t\t\t\t<span class="error hidden">Trouble connectingâ€¦ <span class="action retry">Retry</span></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul class="metric-list">\n\t\t\t\t\t\t\t<li class="empty">\n\t\t\t\t\t\t\t\t<div class="title">No '+r((e.lower||t&&t.lower||l).call(t,null!=t?t.metricTitle:t,{name:"lower",hash:{},data:s}))+' archived</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\n\t\t\t\t</div>\n\t\t\t\t</div>\x3c!--\n\t\t\t\t--\x3e<div class="subview list-view metric-home" data-test="metric-list-panel">\n\t\t\t\t\t<header class="header">\n\t\t\t\t\t\t<div class="title-wrapper">\n\t\t\t\t\t\t\t<img src="img/'+r(typeof(a=null!=(a=e.metricIcon||(null!=t?t.metricIcon:t))?a:l)==o?a.call(t,{name:"metricIcon",hash:{},data:s}):a)+'" class="app-icon">\n\t\t\t\t\t\t\t<span class="title">'+r(typeof(a=null!=(a=e.metricTitle||(null!=t?t.metricTitle:t))?a:l)==o?a.call(t,{name:"metricTitle",hash:{},data:s}):a)+'</span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="controls">\n'+(null!=(n=e.if.call(t,null!=t?t.showAddNew:t,{name:"if",hash:{},fn:this.program(2,s,0),inverse:this.noop,data:s}))?n:"")+'\n\t\t\t\t\t\t\t<div class="control more">\n\t\t\t\t\t\t\t\t<div class="icon-wrapper more-toggle" data-test="metric-menu">\n\t\t\t\t\t\t\t\t\t'+(null!=(n=(e.iconEllipsis||t&&t.iconEllipsis||l).call(t,"more-icon",{name:"iconEllipsis",hash:{},data:s}))?n:"")+'</div>\n\t\t\t\t\t\t\t\t<div class="dropdown more-dropdown">\n\t\t\t\t\t\t\t\t\t<ul class="dropdown-list">\n'+(null!=(n=e.if.call(t,null!=t?t.showArchiveMenu:t,{name:"if",hash:{},fn:this.program(4,s,0),inverse:this.noop,data:s}))?n:"")+(null!=(n=e.if.call(t,null!=t?t.showEditTeamWidgets:t,{name:"if",hash:{},fn:this.program(6,s,0),inverse:this.noop,data:s}))?n:"")+'\t\t\t\t\t\t\t\t\t\t<li class="dropdown-item has-toggle toggle-random" title="Show a random chosen '+r((e.lower||t&&t.lower||l).call(t,null!=t?t.metricType:t,{name:"lower",hash:{},data:s}))+' each load">\n\t\t\t\t\t\t\t\t\t\t\t<span class="setting-title">Show Random</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</header>\n\t\t\t\t\t<div class="body">\n\t\t\t\t\t\t<div class="empty">\n\t\t\t\t\t\t\t<div class="title">No '+r((e.lower||t&&t.lower||l).call(t,null!=t?t.metricTitle:t,{name:"lower",hash:{},data:s}))+' yet</div>\n\t\t\t\t\t\t\t<div class="description">'+r(typeof(a=null!=(a=e.metricDescription||(null!=t?t.metricDescription:t))?a:l)==o?a.call(t,{name:"metricDescription",hash:{},data:s}):a)+'</div>\n\t\t\t\t\t\t\t<div class="button add">New '+r(typeof(a=null!=(a=e.metricType||(null!=t?t.metricType:t))?a:l)==o?a.call(t,{name:"metricType",hash:{},data:s}):a)+'</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ul class="metric-list">\n\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\x3c!--\n\t\t\t\t--\x3e<div class="subview metric-detail metric-detail-add" data-test="metric-edit-panel">\n\t\t\t\t\t<header class="header">\n\t\t\t\t\t\t<div class="control">\n\t\t\t\t\t\t\t<div class="icon-wrapper back">\n\t\t\t\t\t\t\t\t<i class="icon icon-left"></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-mode controls">\n\t\t\t\t\t\t\t<div class="control more" data-test="metric-more">\n\t\t\t\t\t\t\t\t<div class="icon-wrapper more-toggle">\n\t\t\t\t\t\t\t\t\t'+(null!=(n=typeof(a=null!=(a=e.iconEllipsis||(null!=t?t.iconEllipsis:t))?a:l)==o?a.call(t,{name:"iconEllipsis",hash:{},data:s}):a)?n:"")+'</div>\n\n\t\t\t\t\t\t\t\t<div class="dropdown more-dropdown">\n\t\t\t\t\t\t\t\t\t<ul class="dropdown-list">\n'+(null!=(n=e.if.call(t,null!=t?t.archived:t,{name:"if",hash:{},fn:this.program(8,s,0),inverse:this.program(10,s,0),data:s}))?n:"")+'\t\t\t\t\t\t\t\t\t\t<li class="delete" data-test="metric-delete">\n\t\t\t\t\t\t\t\t\t\t\t<span class="dropdown-list-icon-wrapper">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg class="dropdown-list-icon icon icon-trash" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 24"><path d="M19.15 7.5H2.838a.5.5 0 0 0-.5.5l1.81 14a2 2 0 0 0 2 2h9.954a2 2 0 0 0 2-2L19.65 8a.5.5 0 0 0-.5-.5zm-9.9 13a.75.75 0 0 1-1.5 0v-9a.75.75 0 0 1 1.5 0v9zm5 0a.75.75 0 0 1-1.5 0v-9a.75.75 0 0 1 1.5 0v9zM20.43 4h-4.18a.25.25 0 0 1-.25-.25V2.5A2.5 2.5 0 0 0 13.5 0h-5A2.5 2.5 0 0 0 6 2.5v1.25a.25.25 0 0 1-.25.25h-4.5a1 1 0 0 0 0 2h19.18a1 1 0 0 0 0-2zM8 3.75V2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v1.25a.25.25 0 0 1-.25.25h-5.5A.25.25 0 0 1 8 3.75z" fill-rule="nonzero"/></svg>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="dropdown-list-label">Delete</span>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</header>\n\t\t\t\t\t<div class="body"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},2:function(t,e,i,s){return'\t\t\t\t\t\t\t<div class="control add" data-test="metric-add">\n\t\t\t\t\t\t\t\t<div class="icon-wrapper">\n\t\t\t\t\t\t\t\t\t<svg class="icon icon-plus" viewBox="0 0 448 448" xmlns="http://www.w3.org/2000/svg"><path d="m408 184h-136c-4.417969 0-8-3.582031-8-8v-136c0-22.089844-17.910156-40-40-40s-40 17.910156-40 40v136c0 4.417969-3.582031 8-8 8h-136c-22.089844 0-40 17.910156-40 40s17.910156 40 40 40h136c4.417969 0 8 3.582031 8 8v136c0 22.089844 17.910156 40 40 40s40-17.910156 40-40v-136c0-4.417969 3.582031-8 8-8h136c22.089844 0 40-17.910156 40-40s-17.910156-40-40-40zm0 0"/></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n'},4:function(t,e,i,s){return'\t\t\t\t\t\t\t\t\t\t<li class="dropdown-item show-archived" data-test="metric-show-archive">\n\t\t\t\t\t\t\t\t\t\t\t<span class="dropdown-list-icon-wrapper">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg class="dropdown-list-icon icon icon-archive" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 20"><g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M22.75 6.75l-1.204 9c0 1.657-1.93 3-3.588 3H7.99c-1.657 0-3.406-1.343-3.406-3l-1.334-9M22.75 1.25H3.25a1.5 1.5 0 0 0-1.5 1.5v3h22.5v-3a1.5 1.5 0 0 0-1.5-1.5z"/><path d="M16 10.85c0 1.16-.672 2.1-1.5 2.1h-3c-.828 0-1.5-.94-1.5-2.1 0-1.16.672-2.1 1.5-2.1h3c.828 0 1.5.94 1.5 2.1z"/></g></svg>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="dropdown-list-label">Go to Archive</span>\n\t\t\t\t\t\t\t\t\t\t</li>\n'},6:function(t,e,i,s){var n,a=e.helperMissing,l=this.escapeExpression;return'\t\t\t\t\t\t\t\t\t\t<li class="dropdown-item show-widget-settings" title="Manage team '+l((e.lower||t&&t.lower||a).call(t,null!=t?t.metricTitle:t,{name:"lower",hash:{},data:s}))+'">\n\t\t\t\t\t\t\t\t\t\t\t<span class="dropdown-list-icon-wrapper">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg class="dropdown-list-icon icon icon-settings" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g fill-rule="nonzero"><path d="M12.083 3.591a1.2 1.2 0 0 0-2.084.862l.083 1.74a3.697 3.697 0 0 1-3.884 3.895l-1.747-.09a1.198 1.198 0 0 0-.861 2.083l1.297 1.179a3.7 3.7 0 0 1 .002 5.493l-1.3 1.174a1.197 1.197 0 0 0 .868 2.083l1.757-.089a3.697 3.697 0 0 1 3.874 3.883l-.09 1.742a1.198 1.198 0 0 0 2.083.864l1.178-1.296a3.699 3.699 0 0 1 5.492-.003l1.17 1.295c.24.262.584.404.939.388a1.197 1.197 0 0 0 1.144-1.243l-.089-1.758a3.697 3.697 0 0 1 3.882-3.874l1.75.089a1.198 1.198 0 0 0 .866-2.086l-1.302-1.174a3.7 3.7 0 0 1-.001-5.494l1.302-1.174a1.199 1.199 0 0 0-.861-2.087l-1.756.09a3.698 3.698 0 0 1-3.87-3.88l.09-1.75a1.198 1.198 0 0 0-2.091-.861l-1.177 1.292a3.696 3.696 0 0 1-5.492.001l-1.172-1.294zm3.026-.383a1.197 1.197 0 0 0 1.785-.002l1.178-1.294a3.698 3.698 0 0 1 6.439 2.668l-.089 1.749a1.197 1.197 0 0 0 1.252 1.256l1.752-.089a3.699 3.699 0 0 1 2.661 6.44l-1.301 1.174a1.201 1.201 0 0 0-.001 1.78l1.303 1.176a3.698 3.698 0 0 1-2.668 6.439l-1.751-.09a1.196 1.196 0 0 0-1.257 1.26l.09 1.757a3.698 3.698 0 0 1-6.43 2.656l-1.176-1.302a1.197 1.197 0 0 0-1.782.003l-1.182 1.302a3.699 3.699 0 0 1-6.43-2.665l.09-1.75a1.196 1.196 0 0 0-1.259-1.258l-1.748.09a3.696 3.696 0 0 1-2.673-6.436l1.3-1.174a1.201 1.201 0 0 0 0-1.784l-1.302-1.18a3.699 3.699 0 0 1 2.665-6.432l1.752.088a1.199 1.199 0 0 0 1.258-1.267l-.084-1.752a3.699 3.699 0 0 1 6.433-2.66l1.175 1.297z"/><path d="M16 11.626a4.375 4.375 0 1 0 0 8.751 4.375 4.375 0 0 0 0-8.75zm0-2.5a6.875 6.875 0 1 1 0 13.751 6.875 6.875 0 0 1 0-13.75z"/></g></svg>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="dropdown-list-label">'+l("function"==typeof(n=null!=(n=e.metricTitle||(null!=t?t.metricTitle:t))?n:a)?n.call(t,{name:"metricTitle",hash:{},data:s}):n)+" Admin</span>\n\t\t\t\t\t\t\t\t\t\t</li>\n"},8:function(t,e,i,s){return'\t\t\t\t\t\t\t\t\t\t<li class="archive">Un-archive</li>\n'},10:function(t,e,i,s){return'\t\t\t\t\t\t\t\t\t\t<li class="archive" data-test="metric-archive">Archive</li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,i,s){var n;return null!=(n=e.unless.call(t,null!=t?t.hidden:t,{name:"unless",hash:{},fn:this.program(1,s,0),inverse:this.noop,data:s}))?n:""},useData:!0}),c.templates.defaultInstance=Handlebars.template({1:function(t,e,i,s){var n;return" (Random "+this.escapeExpression("function"==typeof(n=null!=(n=e.metricType||(null!=t?t.metricType:t))?n:e.helperMissing)?n.call(t,{name:"metricType",hash:{},data:s}):n)+")"},3:function(t,e,i,s){var n;return'<span class="metric-stat-unit">'+this.escapeExpression("function"==typeof(n=null!=(n=e.unit||(null!=t?t.unit:t))?n:e.helperMissing)?n.call(t,{name:"unit",hash:{},data:s}):n)+"</span>"},5:function(t,e,i,s){var n;return'\t\t\t\t<span class="list-control read-only" title="Admin Locked">\n\t\t\t\t\t<svg class="icon icon-lock" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 328.9 402"><path d="M357.45,190.72a26.43,26.43,0,0,0-19.42-8H328.9V127.91q0-52.54-37.68-90.22T201,0q-52.55,0-90.22,37.69T73.09,127.91v54.82H64a27.28,27.28,0,0,0-27.41,27.41V374.59A27.28,27.28,0,0,0,64,402H338a27.28,27.28,0,0,0,27.41-27.41V210.13A26.43,26.43,0,0,0,357.45,190.72Zm-83.36-8H127.91V127.91q0-30.27,21.41-51.68T201,54.82q30.27,0,51.68,21.41t21.41,51.68Z" transform="translate(-36.55)"/></svg>\n\t\t\t\t</span>\n\t\t\t\t'+(null!=(n=e.if.call(t,null!=t?t.allowPin:t,{name:"if",hash:{},fn:this.program(6,s,0),inverse:this.noop,data:s}))?n:"")+"\n"},6:function(t,e,i,s){var n;return null!=(n=e.if.call(t,null!=t?t.pinned:t,{name:"if",hash:{},fn:this.program(7,s,0),inverse:this.noop,data:s}))?n:""},7:function(t,e,i,s){return'\n\t\t\t\t\t<span class="list-control list-pin active" title="Pinned">\n\t\t\t\t\t\t<svg class="icon icon-pin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 481.71 481.72"><path d="M106.12,10.76,10.77,106.13a36.72,36.72,0,0,0,45.92,56.8l109.6,127.41a100.11,100.11,0,0,0,20,113.32,35.27,35.27,0,0,0,49.86,0l57.33-57.31L481.71,481.72,346.35,293.52l57.31-57.31a35.3,35.3,0,0,0,0-49.88,100.16,100.16,0,0,0-113.29-20L162.93,56.67a36.72,36.72,0,0,0-56.81-45.91Z" transform="translate(0 0)"/></svg>\n\t\t\t\t\t</span>\n\t\t\t\t'},9:function(t,e,i,s){var n;return(null!=(n=e.if.call(t,null!=t?t.allowEdit:t,{name:"if",hash:{},fn:this.program(10,s,0),inverse:this.noop,data:s}))?n:"")+(null!=(n=e.if.call(t,null!=t?t.allowPin:t,{name:"if",hash:{},fn:this.program(12,s,0),inverse:this.noop,data:s}))?n:"")+(null!=(n=e.if.call(t,null!=t?t.archived:t,{name:"if",hash:{},fn:this.program(19,s,0),inverse:this.noop,data:s}))?n:"")},10:function(t,e,i,s){return'\t\t\t\t<span class="list-control list-edit" data-test="metric-edit" title="Edit">\n\t\t\t\t\t<svg class="icon icon-gear" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 340.274 340.274"><path d="M293.629 127.806l-5.795-13.739c19.846-44.856 18.53-46.189 14.676-50.08l-25.353-24.77-2.516-2.12h-2.937c-1.549 0-6.173 0-44.712 17.48l-14.184-5.719c-18.332-45.444-20.212-45.444-25.58-45.444h-35.765c-5.362 0-7.446-.006-24.448 45.606l-14.123 5.734C86.848 43.757 71.574 38.19 67.452 38.19l-3.381.105-27.27 26.737c-4.138 3.891-5.582 5.263 15.402 49.425l-5.774 13.691C0 146.097 0 147.838 0 153.33v35.068c0 5.501 0 7.44 46.585 24.127l5.773 13.667c-19.843 44.832-18.51 46.178-14.655 50.032l25.353 24.8 2.522 2.168h2.951c1.525 0 6.092 0 44.685-17.516l14.159 5.758c18.335 45.438 20.218 45.427 25.598 45.427h35.771c5.47 0 7.41 0 24.463-45.589l14.195-5.74c26.014 11 41.253 16.585 45.349 16.585l3.404-.096 27.479-26.901c3.909-3.945 5.278-5.309-15.589-49.288l5.734-13.702c46.496-17.967 46.496-19.853 46.496-25.221V151.88c-.005-5.519-.005-7.446-46.644-24.074zM170.128 228.474c-32.798 0-59.504-26.187-59.504-58.364 0-32.153 26.707-58.315 59.504-58.315 32.78 0 59.43 26.168 59.43 58.315-.006 32.177-26.656 58.364-59.43 58.364z"></path></svg>\n\t\t\t\t</span>\n'},12:function(t,e,i,s){var n;return'\t\t\t\t\t<span class="list-control list-pin'+(null!=(n=e.if.call(t,null!=t?t.pinned:t,{name:"if",hash:{},fn:this.program(13,s,0),inverse:this.noop,data:s}))?n:"")+'" title="'+(null!=(n=e.if.call(t,null!=t?t.pinned:t,{name:"if",hash:{},fn:this.program(15,s,0),inverse:this.program(17,s,0),data:s}))?n:"")+'">\n\t\t\t\t\t\t<svg class="icon icon-pin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 481.71 481.72"><path d="M106.12,10.76,10.77,106.13a36.72,36.72,0,0,0,45.92,56.8l109.6,127.41a100.11,100.11,0,0,0,20,113.32,35.27,35.27,0,0,0,49.86,0l57.33-57.31L481.71,481.72,346.35,293.52l57.31-57.31a35.3,35.3,0,0,0,0-49.88,100.16,100.16,0,0,0-113.29-20L162.93,56.67a36.72,36.72,0,0,0-56.81-45.91Z" transform="translate(0 0)"/></svg>\n\t\t\t\t\t</span>\n'},13:function(t,e,i,s){return" active "},15:function(t,e,i,s){return" Unpin "},17:function(t,e,i,s){return"Pin"},19:function(t,e,i,s){return'\t\t\t\t\t<span class="list-control list-unarchive">\n\t\t\t\t\t\t<svg class="icon icon-unarchive"  data-test="metric-unarchive" title="Unarchive" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 438.53 438.53"><path d="M421.12,134.19q-17.4-40.54-46.81-69.95t-70-46.82a216.26,216.26,0,0,0-166.3-1.57A221.7,221.7,0,0,0,68.24,60.53L31.12,23.7q-8.57-8.86-19.7-4Q0,24.56,0,36.55v127.9A17.56,17.56,0,0,0,5.43,177.3a17.56,17.56,0,0,0,12.85,5.43h127.9q12,0,16.85-11.42,4.84-11.15-4-19.71l-39.12-39.39a141.7,141.7,0,0,1,45.69-29,144.9,144.9,0,0,1,53.67-10.14A142.56,142.56,0,0,1,276,84.65a144.79,144.79,0,0,1,77.94,77.95,144.69,144.69,0,0,1,0,113.34A144.79,144.79,0,0,1,276,353.89a145,145,0,0,1-172-45.26q-2-2.85-6.57-3.43a10.28,10.28,0,0,0-7.14,2.57l-39.11,39.4A8.49,8.49,0,0,0,48.68,353a10.24,10.24,0,0,0,1.86,6.43,214.2,214.2,0,0,0,75.37,58.38,217.74,217.74,0,0,0,93.36,20.7,213.31,213.31,0,0,0,85.08-17.41q40.54-17.42,69.95-46.82t46.82-69.95a216.59,216.59,0,0,0,0-170.16Z" transform="translate(0 0)"/></svg>\n\t\t\t\t\t</span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,i,s){var n,a,l=e.helperMissing,r="function",o=this.escapeExpression;return'<div class="metric-data" title="'+o(typeof(a=null!=(a=e.tooltip||(null!=t?t.tooltip:t))?a:l)==r?a.call(t,{name:"tooltip",hash:{},data:s}):a)+(null!=(n=e.if.call(t,null!=t?t.random:t,{name:"if",hash:{},fn:this.program(1,s,0),inverse:this.noop,data:s}))?n:"")+'" data-test="metric-instance">\n\t<div class="metric-stat-row">\n\t\t<div class="metric-stat">\n\t\t\t<span class="metric-stat-number">'+o(typeof(a=null!=(a=e.time||(null!=t?t.time:t))?a:l)==r?a.call(t,{name:"time",hash:{},data:s}):a)+"</span>"+(null!=(n=e.if.call(t,null!=t?t.unit:t,{name:"if",hash:{},fn:this.program(3,s,0),inverse:this.noop,data:s}))?n:"")+'\n\t\t</div>\n\n\t\t<div class="list-controls">\n'+(null!=(n=e.if.call(t,null!=t?t.readOnly:t,{name:"if",hash:{},fn:this.program(5,s,0),inverse:this.program(9,s,0),data:s}))?n:"")+'\t\t</div>\n\t</div>\n\t<div class="metric-label" data-test="metric-label">\n\t\t<span class="metric-label-name">'+(null!=(n=typeof(a=null!=(a=e.nameOrPlaceholder||(null!=t?t.nameOrPlaceholder:t))?a:l)==r?a.call(t,{name:"nameOrPlaceholder",hash:{},data:s}):a)?n:"")+"</span>\n\t</div>\n</div>\n"},useData:!0}),c.styles=c.styles||{},c.styles.style=function(){var t=document.createElement("style");t.type="text/css",t.innerHTML=".base-metric{--item-side-padding:8px;order:3}.base-metric .app-dash{position:relative;z-index:1}.base-metric .add-shadow:before{border-bottom-right-radius:20%}.top-right .base-metric:first-child .app-dash{padding-right:10px}.app-dash .icon-random{display:none}.metric-dash .metric-stat{max-width:14ch;overflow:hidden;text-overflow:ellipsis}.base-metric .app-wrapper{position:absolute}.base-metric .nipple-top-right:after{right:28px!important}.base-metric .app{--metric-width:230px;width:var(--metric-width);padding:0;right:0;transition:all var(--a--fast) ease,left 0s ease}.base-metric .subviews{width:calc(var(--metric-width) * 4)}.base-metric .subview{width:var(--metric-width);display:inline-flex;flex-direction:column}.base-metric .header{height:var(--header-height);padding-top:3px;flex-shrink:0}.base-metric .add .icon-wrapper{margin-right:2px;padding-left:12px}.base-metric .body{width:100%;padding:0 var(--app-padding) calc(var(--app-padding) - var(--item-side-padding));flex:1 1 auto;box-sizing:border-box;overflow-y:auto;overflow-x:hidden}.base-metric.hide-scroll .body{overflow:hidden}.base-metric .metric-list{margin-right:calc((var(--metric-width) - (100% + var(--app-padding) * 2)) * -1)}.metric-list-item{margin:0 calc(var(--item-side-padding) * -1) 3px;padding:5px var(--item-side-padding);position:relative;display:flex;justify-content:space-between;border-radius:3px;cursor:pointer}.metric-list-item:hover{background:rgba(255,255,255,.07)}.metric-list-item.selected{background:rgba(255,255,255,.12)}.metric-list-item.ignore-click{cursor:default}.light .metric-list-item:hover{background:rgba(0,0,0,.04)}.light .metric-list-item.selected{background:rgba(0,0,0,.08)}.metric-list-item:last-child{margin-bottom:0}.base-metric .list-item .read-only{opacity:0;transition:opacity var(--a-fast) var(--a-curve)}.base-metric .list-item:hover .read-only{opacity:.4;cursor:default}.metric-list .metric-stat{font-size:1.4375rem;overflow:hidden;line-height:1.2}.metric-list .metric-stat-unit{font-size:1.1875rem}.metric-list .metric-label{max-width:none;padding:0}.metric-list .metric-message{margin-top:-2px;display:none;opacity:.5;font-size:.75rem}.auth-needed .metric-message{display:block}.base-metric .icon-alert{height:12px;margin-right:1px;vertical-align:-5%;display:none}.metric-list .icon-alert{fill:red}.auth-needed .icon-alert{display:inline}.metric-archive .header{position:relative;justify-content:center}.metric-archive .header svg{width:16px;margin-top:2px;stroke:var(--app-text-color)}.metric-archive .header .title{margin-left:7px}.metric-archive .controls{position:absolute;right:0}.metric-archive .back{padding-right:calc(var(--app-padding) - 3px)}.metric-archive .message{min-height:120px;margin:0;padding:var(--app-padding);display:flex;align-items:center;justify-content:center;background:0 0}.metric-archive .hidden,.metric-archive .metric-list{display:none}.metric-archive .metric-list.active{display:block}.metric-home .header{padding-left:var(--app-padding)}.metric-home .more-dropdown{width:190px;right:calc(var(--app-padding) - var(--item-side-padding) + 2px)}.dropdown-list-icon-wrapper .icon-archive,.metric-home .icon-archive{width:14px;stroke:var(--icon-color)}.metric-home .icon-settings{width:15px;fill:var(--icon-color)}.metric-home .show-archived:hover .icon-archive,.metric-home .show-widget-settings:hover .icon-settings{opacity:1}.metric-detail .edit-mode{display:none}.metric-detail .edit-mode.visible{display:flex}.metric-edit-controls .save{background:0 0;background:rgba(255,255,255,.4)}.metric-edit-controls .save.disabled{cursor:auto;opacity:.5}.base-metric .create-pinned-group{display:flex;justify-content:space-between;align-items:center;cursor:pointer}.base-metric .create-pinned-group label{padding-bottom:1px;display:inline-block;cursor:pointer;font-size:.75rem}.base-metric .create-pinned-group:hover label{opacity:8}.metric-detail-add .has-toggle{--border:1px solid var(--border-color-low);padding:5px 0;border-top:var(--border);border-bottom:var(--border)}.metric-detail-add .metric-edit-input::placeholder{opacity:.3}.metric-dash-empty{display:none}.app-empty .metric-dash-empty{display:block}.metric-dash-empty .sets-height{visibility:hidden}.metric-dash-empty .absolute{position:absolute;top:0;right:0;bottom:0;left:0;display:flex;justify-content:flex-end;align-items:center}.metric-dash-empty .absolute svg{height:17px;width:17px;fill:#fff}.base-metric .empty{padding:0}.base-metric.app-empty .metric-home .empty{display:flex}.base-metric .loading-icon{vertical-align:-15%}.base-metric .loading-label{font-size:.875rem}.app-metric .option-action{margin:-6px;padding:6px;display:inline-block;cursor:pointer;font-size:87.5%;opacity:.6;overflow:hidden;transition:.1s all ease-in}.app-metric .option-action:hover{opacity:.8}.app-metric .option-form{padding-top:0;position:relative;transition:height .3s ease;overflow:hidden}.app-metric .option-wrapper.active .option-form{opacity:1}.app-metric .option-form .option-cancel{padding:3px;cursor:pointer;opacity:.6}.app-metric .option-form .option-cancel:hover{opacity:1}.app-metric .add-time-group{height:0;width:100%;opacity:0;transition:opacity .3s ease}.app-metric .add-time.active .add-time-group{height:auto;opacity:1}.app-metric .time-expand{margin:-5px 0 0 -10px;padding:5px 10px 0;display:inline-block;cursor:pointer;opacity:.8;transition:opacity .3s ease}.app-metric .time-expand:hover{opacity:1}.app-metric .time-expand label{display:inline-block;text-transform:uppercase;cursor:pointer;opacity:.8}.app-metric .x-caret{height:10px;width:10px;position:relative;display:inline-block;transform:translateY(2.5px);transition:transform .5s ease}.app-metric .x-caret-left,.app-metric .x-caret-right{height:7px;width:7px;position:absolute;transition:all .3s ease}.app-metric .x-caret.u--no-transition .icon{transition:none}.app-metric .x-caret-left{transform:rotate(45deg);left:0}.app-metric .x-caret-right{transform:rotate(-45deg);left:4px}.app-metric .add-time.active .x-caret{transform:translateY(2.5px)}.app-metric .add-time.active .x-caret-left{transform:scale(1.1) skewY(30deg) rotate(200deg);left:2px}.app-metric .add-time.active .x-caret-right{transform:scale(1.1) skewY(-30deg) rotate(-200deg);left:2px}.read-only .list-pin{cursor:default}",document.getElementsByTagName("head")[0].appendChild(t)},c.models.BaseMetricModel=Backbone.Model.extend({initialize:function(t){t=t||{},this.idAttribute=this.collection.idAttribute||"csid",this.listenTo(this,"change",this.onChange);var i=this;this.get("isTeam")&&!this.get("readOnly")&&(this.editDetailOverride=function(){var t=i.get("id");t.toUpperCase().startsWith("T")&&(t=t.substr(1));var e="/team/"+i.collection.accountSitePath+"?id="+t;l.commandManager.execute("window.account.open",e)}),Backbone.Model.prototype.initialize.call(this,t)}}),c.views.MetricInstance=Backbone.View.extend({tagName:function(){return"listItem"===this.options.type?"li":"div"},events:{click:"handleMetricClick","webkitAnimationEnd .metric-instance":"onAnimationEnd","click .list-edit":"editDetail","click .list-pin":"pinMetric","click .list-unarchive":"unarchive"},initialize:function(t){this.parent=t.parent,this.model=t.model,this.model&&(this.collection=this.model.collection),this.template=t.template||c.templates.defaultInstance,this.class=t.class,this.type=t.type,this.maxCharPerLine=14,this.listenTo(this.model,"change",this.onChange),this.listenTo(this.model,"replace",this.onReplace)},editDetail:function(t){t.stopPropagation(),this.model.editDetailOverride?this.model.editDetailOverride():"dash"===this.type||this.model.get("readOnly")||this.parent.editDetail(this.model)},onChange:function(){this.model.get("deleted")?this.destroy():this.render()},onReplace:function(t){var e=this.collection||this.model.collection;this.model=e.findWhere({id:t.replacedBy}),this.listenTo(this.model,"change",this.onChange),this.render()},destroy:function(){this.$el.remove(),this.remove()},render:function(){var t=this.model.getViewData();return(t.pinned||this.model.get("selected")||this.model.get("random"))&&(t.active=!0),this.model.get("random")&&(t.random=!0),this.model.get("readOnly")&&(t.readOnly=!0),t.allowEdit=!this.model.allowEdit||this.model.allowEdit(),t.allowPin=this.model.allowPin?!this.model.get("archived")&&this.model.allowPin():!this.model.get("archived"),t.allowEdit||t.allowPin||(t.readOnly=!0),"dash"===this.type&&t.active&&(t.nameOrPlaceholder=lineBreakString(t.nameOrPlaceholder,this.maxCharPerLine)),this.$el.html(this.template(t)),this.$el.addClass(this.class),this.$el.toggleClass("pinned-metric",this.model.get("pinned")),this.$el.toggleClass("read-only",this.model.get("readOnly")),this.$el.toggleClass("random random-metric",this.model.get("random")),this.$el.toggleClass("ignore-click",!this.model.get("externalUrl")&&"dash"!==this.type),this.$el.find(".list-random").toggleClass("active",this.model.get("random")),this},onAnimationEnd:function(t){"pulse"===t.originalEvent.animationName&&this.$el.removeClass("pulse")},pulse:function(t){this.$el.addClass("pulse")},handleMetricClick:function(t){"dash"===this.type&&this.parent.togglePopup(this)},pinMetric:function(t){t.stopPropagation(),this.model.get("readOnly")||(this.model.editDetailOverride?this.model.editDetailOverride():this.model.togglePinned())},unarchive:function(t){t.stopPropagation(),this.model.toggleArchive()}}),c.views.BaseMetric=Backbone.View.extend({attributes:{class:"app-container base-metric metric hide-scroll"},template:c.templates.baseMetric,events:{"click .metric-dash-empty":"addMetricFromDashboard","click .add":"toggleAdding","click .more-toggle":"toggleDropdown","click .show-archived":"showArchived","click .toggle-random":"toggleRandom","click .back":"hideDetail","click .delete":"deleteMetric","click .archive":"toggleArchive","click .add-integration":"addIntegration","click .show-widget-settings":"goToWidgetAdmin"},initialize:function(t){if(this.desiredTop=0,this.desiredRight=0,this.isOpen=!1,this.renderedOnce=!1,this.listenTo(l,"globalEvent:esc",this.hide),this.listenTo(l,"globalEvent:window:resize "+t.metricType.toLowerCase()+":resize",this.handleResize),this.listenTo(l.models.customization,"change:themeFont",this.render),this.listenTo(l,"globalEvent:click",this.handleGlobalClick),this.manager=t.manager,this.detailViewAddin=t.detailViewAddin,this.collection=this.manager.collection,this.metricTitle=t.metricTitle,this.metricIcon=t.metricIcon,this.metricType=t.metricType,this.hideIfEmpty=t.hideIfEmpty,this.visibleSetting=t.visibleSetting,this.metricDescription=t.metricDescription,this.instanceTemplate=t.instanceTemplate,this.instanceView=t.instanceView,this.updateInterval=t.updateInterval,this.rateLimitOnUpdateInterval=t.rateLimitOnUpdateInterval,this.supportArchive=!t.disableArchive,this.supportAddNew=!this.collection.supportAddNew||this.collection.supportAddNew(),this.supportEditTeamWidgets=!this.collection.supportEditTeamWidgets||this.collection.supportEditTeamWidgets(),this.addOverrideCommand=t.addOverrideCommand,this.listenTo(l.models.customization,"change:"+this.visibleSetting,this.visibleChanged),void 0===l.models.customization.get(this.getShowRandomKey())){l.models.customization.set(this.getShowRandomKey(),t.defaultShowRandomState||!1);var e=l.models.customization.get("hideRandomMetric");"undefined"!==e&&"Countdown"===this.metricType&&l.models.customization.get(this.getShowRandomKey(),!e)}this.heightLimit=0,this.currentSubview="second";var n=this;this.listenTo(l,"newDay",this.updateViews),this.listenTo(this.collection,"replace",this.replaceModel),this.listenTo(this.collection,"refresh",function(){n.render({keepRandom:!0})}),this.listenTo(this.collection,"reset",function(t,e,i){n.ready=!0,n.render(i,t)}),this.listenTo(this.collection,"add",function(t,e,i){t.get(t.idAttribute)&&!t.get("archived")&&n.addMetricView(t,i&&i.ignoreRender,!0)}),this.listenTo(this.collection,"remove",function(t,e){n.removeViewsOf(t)}),this.listenTo(this.collection,"change",function(t,e){if(t&&t.get("deleted")&&n.removeViewsOf(t),t){var i=Object.keys(t.changed);if(0<=i.indexOf("selected")&&(t.get("selected")&&n.selectModel(t),t.get("pinned")?t.set({selected:!1},{silent:!0}):this.selectedMetric!==t||this.selectedMetric.get("selected")||(this.selectedMetric.get("pinned")||this.removeFromDash(this.selectedMetric),this.selectedMetric=null)),0<=i.indexOf("pinned"))if(t.get("pinned")){n.renderRandomModel();var s=n.getDashView(t);(s=s||n.addToDash(t)).pulse()}else this.selectedMetric!==t&&setTimeout(function(){n.removeFromDash(t)});0<=i.indexOf("archived")&&(t.get("archived")?(t.get("random")&&this.resetCurrentRandom(),n.selectedMetric===t&&(n.selectedMetric=null),n.removeViewsOf(t),n.collection.includeArchived&&n.addOne(t)):(n.removeViewsOf(t),setTimeout(function(){n.addMetricView(t)})))}}),this.collection.fetchedOnce&&(this.ready=!0),this.render(),this.updateInterval&&("onWholeMinute"===this.updateInterval?this.listenTo(l.models.date,"change:date",this.updateViews):setInterval(this.updateViews.bind(this),this.updateInterval)),this.$el.mClickOutside(this,this.hide)},goToWidgetAdmin:function(){l.commandManager.execute("window.account.open","/team/"+this.metricTitle.toLowerCase())},getCustomizationKey:function(){return this.metricType.toLowerCase()+"Visible"},removeFromDash:function(t,e){if(t){var i=this.getDashView(t);if(i){i.destroy(),delete this.dashViews[t.get(t.idAttribute)],this.dashViewsArray.splice(this.dashViewsArray.indexOf(i),1),e||!this.emptyDash()&&!this.showingRandom()||this.renderRandomModel();var s=this;setTimeout(function(){t.get(t.idAttribute)===s.lastTargetId&&s.show()},50)}}},removeFromList:function(t){if(t){var e=this.getListView(t);e&&(e.destroy(),delete this.listViews[t.get(t.idAttribute)],this.listViewsArray.splice(this.listViewsArray.indexOf(e),1),this.isOpen&&this.unfocusOverlap(),this.checkEmptyState())}},checkEmptyState:function(){this.$el.toggleClass("app-empty",this.isListEmpty())},isListEmpty:function(e){return 0===this.collection.filter(function(t){return(e?t.get("archived"):!t.get("archived"))&&!t.get("deleted")}).length},removeViewsOf:function(t){this.removeFromDash(t),this.removeFromList(t)},updateViews:function(){if(this.dashViews&&this.listViews){if(this.options.fetchBeforeUpdate){var t="metrics-last-fetch-date",e=(new Date).getTime()-this.rateLimitOnUpdateInterval,i=localStorage.getItem(t);(!i||i&&Number(i)<e)&&(this.collection.fetch({skipLocalFetch:!0,success:n}),localStorage.setItem(t,(new Date).getTime()))}else n();var s=this}function n(){s&&s.dashViews&&s.listViews&&(Object.values(s.dashViews).forEach(a),Object.values(s.listViews).forEach(a))}function a(t){t.render()}},visibleChanged:function(t){l.models.customization.get(this.visibleSetting)?this.renderedOnce?this.$el.mFadeIn():this.render():this.$el.mFadeOut()},showingRandom:function(){return l.models.customization.get(this.getShowRandomKey())},updateDetails:function(){this.$el.find(".toggle-random").toggleClass("on",this.showingRandom())},setRandomMetric:function(){this.resetCurrentRandom(!0);var t=this.getCollectionItems(),e=this.getPinned(),i=0===e.length;if(this.selectedMetric&&!this.selectedMetric.get("pinned"))this.cleanRandomFlag();else if(!this.randomModel||0<=e.indexOf(this.randomModel)||t.indexOf(this.randomModel)<0){var s=[];t.forEach(function(t){e.indexOf(t)<0&&!t.get("archived")&&s.push(t)}),(i||this.showingRandom())&&0<s.length?this.randomModel=s[Math.floor(Math.random()*s.length)]:this.cleanRandomFlag()}this.randomModel&&this.randomModel.set("random",!0)},getCollectionItems:function(){var t=this.collection.activeItems?this.collection.activeItems():this.collection.models;return this.collection.sorted||(t=this.sort(t)),t},render:function(t,e,i){if(this.$el.attr("data-test",this.metricType.toLowerCase()),this.ready){if((t=t||{}).ignoreRender||t.silent||this.$subviews&&this.$subviews.hasClass("third"))this.$subviews&&this.$subviews.hasClass("third")&&(this.missedRender=!0);else{this.dropdownOpen=!1,this.dashViews={},this.listViews={},this.dashViewsArray=[],this.listViewsArray=[];var s=l.models.teamInfo.get("team"),n=this.getCollectionItems(),a={metrics:n,showArchive:this.collection.includeArchived,showArchiveMenu:this.supportArchive,showAddNew:this.supportAddNew,showEditTeamWidgets:this.supportEditTeamWidgets&&s&&s.userIsAdmin,metricType:this.metricType,metricTitle:this.metricTitle,metricIcon:this.metricIcon,metricDescription:this.metricDescription};n[0]&&n[0].getDetailViewVariables();this.selectedMetric&&this.getPinned().indexOf(this.selectedMetric)<0&&(a.selectedMetric=this.selectedMetric),this.randomModel&&t.keepRandom&&this.randomModel.collection&&!this.randomModel.get("deleted")||this.setRandomMetric(),a.randomMetric=this.randomModel,a.empty=0===n.length,a.hidden=a.empty&&this.hideIfEmpty,this.$el.html(this.template(a)),this.renderedOnce?this.$el.attr("data-test-state","fetched"):this.renderedOnce=!0,this.detailView=null,this.$appDash=this.$el.find(".metric-dash.has-multiple"),this.$metricHomeList=this.$el.find(".metric-home .metric-list"),this.$metricArchiveList=this.$el.find(".metric-archive .metric-list"),this.addAll(a),this.checkEmptyState(),this.$popup=this.$(".app-wrapper"),this.$app=this.$(".app"),this.isOpen&&(e||this.lastShownModel)&&(e||!(e=this.lastShownModel).collection&&e.mainContent&&(e=this.collection.findWhere(e.mainContent())),this.show(e,!0,i)),this.$subviews=this.$el.find(".subviews").first(),this.handleResize(),this.$el.find(".toggle-archived").toggleClass("on",this.collection.includeArchived),this.updateDetails(),this.loadTriggered||(l.widgetManager.appReady(c.info.id),this.loadTriggered=!0)}}},getDetailView:function(){var i=this;return new Promise(function(e){i.detailView?e():i.createDetailView({el:i.$el.find(".metric-detail .body"),collection:i.collection,parentView:i}).then(function(t){i.detailView=t,e()})})},sort:function(t){var e=t;try{e=t.sort(function(t,e){return!t.get("pinned")||e.get("pinned")?!e.get("pinned")||t.get("pinned")?0:1:-1})}catch(t){}return e},addToDash:function(t,e){if(t){if(this.dashViews[t.get(t.idAttribute)])return this.dashViews[t.get(t.idAttribute)];var i=new(this.instanceView||c.views.MetricInstance)({model:t,class:"metric-item "+(e||""),template:this.instanceTemplate,type:"dash",parent:this}),s=i.render().$el;if(this.emptyDash())this.$appDash.append(s),this.dashViewsArray.push(i);else{var n,a,l=!1,r=this.getCollectionItems(),o=r.indexOf(t);for(n=0;n<r.length;n++){a=r[n];var d=this.getDashView(a);if(o<n&&d){l=!0,d.$el.before(s),this.dashViewsArray.splice(this.dashViewsArray.indexOf(d),0,i);break}}l||(this.$appDash.append(s),this.dashViewsArray.push(i))}return this.dashViews[t.get(t.idAttribute)]=i}},getDashView:function(t){return t?this.dashViews[t.get(t.idAttribute)]:null},getListView:function(t){return t?this.listViews[t.get(t.idAttribute)]:null},resetCurrentRandom:function(t){if(this.randomModel){var e=this.randomModel;this.cleanRandomFlag();var i=this.getListView(e);i&&i.render(),this.removeFromDash(e,t)}},cleanRandomFlag:function(){this.randomModel&&(this.randomModel.set("random",!1),this.randomModel=null)},selectModel:function(t){t.get("pinned")||(this.resetCurrentRandom(!0),this.selectedMetric&&t!==this.selectedMetric&&this.selectedMetric.set("selected",!1),this.selectedMetric=t);var e=this.getDashView(t);e?e.pulse():this.addToDash(t,"selected-metric"),this.show(t,!0)},addOne:function(t,e,i){if(!this.listViews[t.get(t.idAttribute)]){e=e||"";var s=new(this.instanceView||c.views.MetricInstance)({model:t,class:"list-item metric-list-item metric-option "+e,template:this.instanceTemplate,type:"listItem",parent:this});return this.listViews[t.get(t.idAttribute)]=s,i||this.checkEmptyState(),(t.get("archived")?this.$metricArchiveList:this.$metricHomeList).append(s.render().$el),this.listViewsArray.push(s),this.isOpen&&!i&&this.unfocusOverlap(),s}},addAll:function(t){t.randomMetric?this.addToDash(t.randomMetric,"random-metric"):t.selectedMetric&&this.addToDash(t.selectedMetric,"selected-metric");var e=this,i="";t.metrics.forEach(function(t){!t.get("pinned")&&t.get("active")&&(i="active"),e.addOne(t,i,!0),t.get("pinned")&&!t.get("archived")&&e.addToDash(t,"pinned-metric")}),this.checkEmptyState()},createMetric:function(t){var e=this.collection.create(t,{createdNow:!0,ignoreRender:!0});this.addMetricView(e,!1,!0),e.set("selected",!0)},addMetricView:function(t,e,i){if(!this.getListView(t)){if(this.addOne(t,!0),this.switchToListView(),i&&this.resetCurrentRandom(!0),t.get("pinned"))this.addToDash(t,"selected-metric").pulse();this.emptyDash()&&this.renderRandomModel()}},emptyDash:function(){return 0===Object.keys(this.dashViews).length},togglePopup:function(t){this.lastTarget&&this.lastTarget===t?this.hide():this.show(t.model)},getPinned:function(){var t=this.collection.findPinned();return t?Array.isArray(t)||(t=[t]):t=[],t},addMetricFromDashboard:function(){this.isOpen?this.hide():this.show()},getShowRandomKey:function(){return"showRandomMetric-"+this.metricType},renderRandomModel:function(){if(this.setRandomMetric(),this.randomModel){var t=this.getListView(this.randomModel);t&&(t.render(),this.addToDash(this.randomModel,"random-metric"))}this.highlightSelectedMetric()},highlightSelectedMetric:function(t){if(t=t||this.selectedMetric||this.randomModel){this.$el.find(".metric-option").removeClass("selected selected-metric");var e=this.getListView(t);e&&(e.$el.addClass("selected selected-metric"),this.highlightedMetric&&this.highlightedMetric.set({highlighted:!1},{silent:!0}),(this.highlightedMetric=t).set({highlighted:!0},{silent:!0}))}},setDetailViewClass:function(t){this.detailViewClass=t},createDetailView:function(i){var s=this;return new Promise(function(e){function t(){var t=new s.detailViewClass(i);e(t)}s.detailViewClass?t():l.widgetManager.loadWidget(s.detailViewAddin).then(function(){t()})})},deleteMetric:function(t){t&&(t.stopPropagation(),t.preventDefault()),this.randomModel===this.activeMetric&&this.cleanRandomFlag(),this.selectedMetric===this.activeMetric&&(this.selectedMetric=null),this.activeMetric.delete(),this.activeMetric=null,this.toggleDropdown(),this.switchToListView()},toggleArchive:function(t){t&&(t.stopPropagation(),t.preventDefault()),this.toggleDropdown(),this.activeMetric.toggleArchive(),this.switchToListView()},addIntegration:function(t){t.stopPropagation(),t.preventDefault(),l.commandManager.execute("settings.toggle",null,{section:"metrics"}),this.hide()},toggleAdding:function(t){if(this.addOverrideCommand)l.commandManager.execute(this.addOverrideCommand);else{var e=this;this.getDetailView().then(function(){e.detailView.startAdding(),e.showDetail(t),e.$el.find(".edit-mode").removeClass("visible")})}},show:function(t,e,i){t&&(this.lastShownModel=t),this.dropdownOpen&&this.toggleDropdown();var s=this;if(this.$popup){var n,a,l,r,o;this.$popup.removeClass("animated"),this.isOpen=!0,this.options.loadOnListView&&this.options.loadOnListView();(a=t?this.getDashView(t):this.lastTargetId?this.dashViews[this.lastTargetId]:this.dashViews[Object.keys(this.dashViews)[0]])&&(this.lastTarget=a,this.lastTargetId=a.model.get(a.model.idAttribute),n=a.$el),n&&0!==n.length?(l=n[0].getBoundingClientRect(),r=this.$el[0].getBoundingClientRect(),o=this.desiredRight,this.desiredRight=r.left-l.left+r.width-l.width-3,this.desiredTop=l.height):(this.desiredRight=-3,this.desiredTop=this.$el.find(".app-dash:visible").first().outerHeight(!0));var d=i||this.currentSubview;if(this.highlightSelectedMetric(t),this.heightLimit||this.setHeightLimit(),e)return this.$subviews=this.$el.find(".subviews"),this.$popup.css({right:o||this.desiredRight}),this.$el.addClass("show show-fade-in"),this.$subviews.addClass("u--no-transition"),d!==this.currentSubview&&this.switchTo(d),this.$popup.addClass("animated"),setTimeout(function(){s.$popup.css({right:s.desiredRight,top:s.desiredTop})},1),this.switchTo(this.currentSubview),this.$subviews.addClass("animated"),this.$subviews.removeClass("u--no-transition"),!0;this.$popup.css({right:this.desiredRight,top:this.desiredTop}),this.$el.addClass("show"),this.$subviews.addClass("u--no-transition"),this.switchTo(d),setTimeout(function(){s.$el.addClass("show-fade-in"),s.$subviews.addClass("animated")},40),this.updateDetails(),this.$subviews.removeClass("u--no-transition")}},unfocusOverlap:function(){var i=0;a(this.activeViewElement).children().each(function(t,e){i+=e.clientHeight}),l.widgetManager.unfocusOverlap(this.options.region,i)},switchTo:function(t){switch(this.switching=this.isOpen&&this.currentSubview!==t,this.switching&&(this.$subviews.css("height",Math.min(this.$subviews[0].clientHeight,this.heightLimit)),this.$el.addClass("hide-scroll no-tab-transitions")),this.$subviews.removeClass("first second third"),this.$subviews.addClass(t),this.currentSubview=t){case"first":this.activeViewElement=this.$subviews.children()[0];break;case"second":this.activeViewElement=this.$subviews.children()[1];break;case"third":this.activeViewElement=this.$subviews.children()[2]}this.switching&&(this.$subviews.css("height",Math.min(this.activeViewElement.scrollHeight,this.heightLimit)),setTimeout(function(){this.switching=!1,this.$subviews.css("height",""),this.$el.removeClass("hide-scroll no-tab-transitions")}.bind(this),300)),this.isOpen&&this.unfocusOverlap()},switchToListView:function(){this.$(".item-specific-menu-item").remove(),this.switchTo("second")},switchToArchiveView:function(){this.switchTo("first")},switchToDetailView:function(){this.switchTo("third")},showDetail:function(t){this.switchToDetailView();var e=this;setTimeout(function(){e.detailView.focus&&e.detailView.focus()},300)},hideDetail:function(t){this.activeMetric&&this.disableBack&&"third"===this.currentSubview?this.detailView&&this.detailView.focus&&this.detailView.focus():"third"===this.currentSubview&&this.detailView&&this.detailView.hideDetailOverride&&this.detailView.hideDetailOverride()||(this.switchToListView(),this.activeMetric=null,this.$el.find(".edit-mode").removeClass("visible"))},editDetailById:function(t,e){this.editDetail(this.collection.findWhere({id:t}),e)},editDetail:function(t,e){this.activeMetric=t,this.$el.find(".edit-mode").addClass("visible");var i=this;this.getDetailView().then(function(){i.detailView.editDetail(t,e),e&&e.stayOnListView||i.showDetail(),i.$el.find(".more-dropdown .archive").html(t.get("archived")?"Unarchive":'<span class="dropdown-list-icon-wrapper"><svg class="dropdown-list-icon icon icon-archive" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 20"><g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M22.75 6.75l-1.204 9c0 1.657-1.93 3-3.588 3H7.99c-1.657 0-3.406-1.343-3.406-3l-1.334-9M22.75 1.25H3.25a1.5 1.5 0 0 0-1.5 1.5v3h22.5v-3a1.5 1.5 0 0 0-1.5-1.5z"/><path d="M16 10.85c0 1.16-.672 2.1-1.5 2.1h-3c-.828 0-1.5-.94-1.5-2.1 0-1.16.672-2.1 1.5-2.1h3c.828 0 1.5.94 1.5 2.1z"/></g></svg></span><span class="dropdown-list-label">Archive</span>')})},hide:function(t){var e=this.$el.find(".more-dropdown")[0];if(!e||t&&a.contains(e,t.target)||this.dropdownOpen&&this.toggleDropdown(),this.isOpen){this.isOpen=!1,this.lastTarget=null,l.widgetManager.refocusOverlap(this.options.region),this.$el.removeClass("show-fade-in"),this.$el.removeClass("immediate-show");var i=this;setTimeout(function(){i.$el.removeClass("show"),i.switchToListView(),i.missedRender&&i.render()},200)}},setHeightLimit:function(t){var e=this.$el.find(".app-dash:not(.metric-dash-empty)")[0].getBoundingClientRect().bottom+a(".bottom").outerHeight(!0),i=a(".bookmarks-wrapper"),s=0;i.css("transform")&&(s=parseInt(i.css("height"))-parseInt(i.css("transform").split(",")[5])),this.heightLimit=window.innerHeight-(e+s+4),this.$subviews.css("max-height",this.heightLimit+"px")},handleResize:function(t){this.isOpen&&(this.detailView&&this.detailView.handleResize&&this.detailView.handleResize(t),this.setHeightLimit())},handleGlobalClick:function(t){var e=!1;this.dropdownOpen&&(this.$(".more").each(function(){if(this.contains(t.target))return!(e=!0)}),e||this.toggleDropdown())},toggleDropdown:function(t){if(!this.blockDropdownToggle){var e;t?(t.stopPropagation(),(e=a(t.currentTarget).parent()).toggleClass("active",!this.dropdownOpen)):e=this.$el,e.find(".more").toggleClass("active",!this.dropdownOpen),this.dropdownOpen=!this.dropdownOpen;var i=e.closest(".subview"),s=e.find(".more-dropdown").height();if(this.dropdownOpen&&s>i.find(".body")[0].clientHeight){var n=e.closest(".header")[0].clientHeight;this.transitionToNewHeight(s+n)}else this.dropdownOpen||this.switching||(this.blockDropdownToggle=!0,this.transitionToNewHeight(i.height()),setTimeout(function(){this.$subviews.css("height","auto"),this.blockDropdownToggle=!1}.bind(this),300))}},transitionToNewHeight:function(t){this.$subviews.css("height",this.$subviews.height()),this.$subviews.css("height",t)},showArchived:function(t){t&&t.stopPropagation(),this.$el.find(".metric-archive .error-icon").addClass("hidden"),this.$el.find(".metric-archive .message").addClass("hidden"),this.toggleDropdown();var e=this;e.collection.includeArchived&&e.fetchedArchived||(e.$el.find(".metric-archive .loading").removeClass("hidden"),e.$el.find(".metric-archive .message").removeClass("hidden"),e.$el.find(".metric-archive .loading-placeholder").addClass("loading-icon"),e.collection.includeArchived=!0),e.switchToArchiveView(),e.fetchedArchived?(e.$metricArchiveList.toggleClass("is-empty",this.isListEmpty(!0)),e.$el.find(".metric-archive .metric-list").addClass("active")):(this.$el.find(".metric-archive .metric-list").removeClass("active"),setTimeout(function(){e.collection.fetchFromServer(function(){e.$el.find(".metric-archive .loading").addClass("hidden"),e.$el.find(".metric-archive .message").addClass("hidden"),e.fetchedArchived=!0,e.$el.find(".metric-archive .metric-list").addClass("active");var t=e.collection.where({archived:!0});t.forEach(function(t){t.attributes.random=!1,t.attributes.selected=!1,e.addOne(t)}),e.$metricArchiveList.toggleClass("is-empty",0===t.length)},function(){e.$el.find(".metric-archive .error").removeClass("hidden"),e.$el.find(".metric-archive .loading").addClass("hidden"),e.fetchedArchived=!0})},300))},toggleRandom:function(t){t&&t.stopPropagation(),l.models.customization.set(this.getShowRandomKey(),!l.models.customization.get(this.getShowRandomKey())),this.$el.find(".toggle-random").toggleClass("on"),this.selectedMetric&&this.selectedMetric.set("selected",!1),this.selectedMetric=null,this.renderRandomModel()},addItemMenu:function(t){return t.class=t.class||"",t.class+=" item-specific-menu-item",a("<li>",t).prependTo(this.$(".dropdown-list"))}}),c.styles.style(),c};m.addinManager&&m.addinManager.registerAddinFn("ce945086-a64d-4b67-b730-9eb7d7b72030",fn_addin);
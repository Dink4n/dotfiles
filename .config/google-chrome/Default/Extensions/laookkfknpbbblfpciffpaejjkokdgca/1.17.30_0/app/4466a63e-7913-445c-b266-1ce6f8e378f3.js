var fn_addin=function(r,e,t){var i=i||{};i.styles=i.styles||{},i.commands=i.commands||{},i.dependencies=t||i.dependencies||{},i.styles.style=function(){},i.views=i.views||{},i.collect=i.collect||{},i.models=i.models||{},i.templates=i.templates||{},i.info={widget:!0,placeholderType:"metric",id:"multiclock",class:"app-container base-metric metric multiclock",region:"top-right",order:"append",addin:"4466a63e-7913-445c-b266-1ce6f8e378f3",requiredFeature:"countdown",visibleSetting:"multiClockVisible",dependencies:["base_metric"]},r.console.log(r.elapsed()+": "+i.info.id+" started"),i.styles=i.styles||{},i.styles.style=function(){var e=document.createElement("style");e.type="text/css",e.innerHTML=".multiclock{order:1}",document.getElementsByTagName("head")[0].appendChild(e)},i.collect.MultiClocks=r.collect.SyncedCollection.extend({initialize:function(e,t){(t=t||{}).name="clocks",this.accountSitePath="clocks",t.sorted=!0,t.transientProps=["random","selected","time","unit","difference"],t.model=i.models.MultiClock,r.collect.SyncedCollection.prototype.initialize.call(this,e,t)},findPinned:function(){return this.filter(function(e){return!e.get("deleted")&&!e.get("archived")&&e.get("pinned")})},activeItems:function(){var e=this.models.filter(function(e){return!e.get("deleted")}),t=e;try{t=e.sort(function(e,t){return e.get("currentOffset")-t.get("currentOffset")})}catch(e){}return t},supportEditTeamWidgets:function(){var e=r.models.teamInfo.get("team");return e&&e.userIsAdmin}}),i.models.MultiClock=Backbone.Model.extend({defaults:function(){return{name:"",deleted:!1,archived:!1,serverSetId:!1,pinned:!1,random:!1}},placeholder:"Clock",initialize:function(e){n.models.BaseMetricModel.prototype.initialize.call(this,e)},getNameOrPlaceholder:function(){return this.get("name")||this.placeholder},mainContent:function(){var e={};return e.name=this.get("name"),e.timeZoneId=this.get("timeZoneId"),e},getViewData:function(){var e=this.calculateTime();return{id:this.get("id"),pinned:this.get("pinned"),nameOrPlaceholder:this.getNameOrPlaceholder(),placeholder:this.placeholder,timezone:this.get("timeZoneId"),time:e.number,unit:e.unit,tooltip:e.difference,metricType:"Clock",archived:this.get("archived"),selected:!1,random:!1}},calculateTime:function(){var e=r.models.customization.get("hour12clock"),t=parseInt(this.get("currentOffset")),i=this.offsetDate(t),n=i.getUTCMinutes(),o=i.getUTCHours(),l="",c=""+(12<o&&e?o-12:0==o?e?12:"00":e?o:twoDigit(o)),a=this.calculateTimeDifference(i);return e&&(l=12<=o?"p":"a"),{number:c+=":"+twoDigit(n),unit:l,difference:a}},calculateTimeDifference:function(e){var t=r.date(),i=t.getDate()==e.getUTCDate()?"Today":t.getDate()+1==e.getUTCDate()?"Tomorrow":"Yesterday",n=t.getTime(),o=e.getTime()+e.getTimezoneOffset()*mConst("dateMsPerMin"),l=n<o?(o-n)/mConst("dateMsPerHour"):(n-o)/mConst("dateMsPerHour");return i+", "+(o<n?"-":"+")+(l%1!=0?Math.round(10*l)/10:Math.round(l))+" hrs"},offsetDate:function(e){var t=r.date();return e&&t.setUTCSeconds(t.getUTCSeconds()+e),t},getDetailViewVariables:function(){return{timezone:this.timezone,placeholder:this.placeholder}},togglePinned:function(){this.save("pinned",!this.get("pinned"))},toggleArchive:function(){this.save("archived",!this.get("archived"))},delete:function(){this.save("deleted",!0)}}),i.models.MultiClockManager=Backbone.Model.extend({initialize:function(){i.collect.multiClocks=this.collection=new i.collect.MultiClocks,this.collection.fetch({reset:!0}),this.listenTo(r.models.customization,"change:hour12clock",this.onTimeChange),this.listenTo(r.models.date,"change:date",this.onTimeChange)},onTimeChange:function(){this.collection.models.forEach(function(e){var t=e.calculateTime(),i={time:t.number,unit:t.unit};e.set(i,{ignoreRender:!0})})}});var n=i.dependencies.base_metric;return n.info=i.info,i.models.multiClockManager=new i.models.MultiClockManager,i.styles.style(),i.views.multiClock=r.widgetManager.handover("multiclock",n.views.BaseMetric,{model:i.models.multiClock,region:"top-right",order:"append",metricType:"Clock",metricTitle:"Clocks",metricIcon:"icon-clocks.svg",visibleSetting:"multiClockVisible",defaultShowRandomState:!1,metricDescription:"Keep track of time anywhere on Earth",manager:i.models.multiClockManager,detailViewAddin:"multi_clock_detail",updateInterval:"onWholeMinute"}),r.widgets.push(i.views.multiClock),i};m.addinManager&&m.addinManager.registerAddinFn("4466a63e-7913-445c-b266-1ce6f8e378f3",fn_addin);
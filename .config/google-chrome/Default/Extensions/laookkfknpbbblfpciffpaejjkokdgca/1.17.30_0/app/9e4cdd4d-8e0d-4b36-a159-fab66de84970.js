var fn_addin=function(i,t,e){var s=s||{};return s.styles=s.styles||{},s.commands=s.commands||{},s.dependencies=e||s.dependencies||{},s.styles.style=function(){},s.views=s.views||{},s.collect=s.collect||{},s.models=s.models||{},s.templates=s.templates||{},s.info={addin:"9e4cdd4d-8e0d-4b36-a159-fab66de84970",id:"settings_common"},i.console.log(i.elapsed()+": "+s.info.id+" started"),s.models.SettingsManager=Backbone.Model.extend({initialize:function(){this.listenTo(i,"settings:register:nav",this.registerNavItem),this.listenTo(i,"settings:register:subnav",this.registerSubNavItem),this.listenTo(i,"settings:register:panel",this.registerPanel),window.addEventListener("storage",function(t){"loggedOut"!=t.key&&"loggedIn"!=t.key||window.location.reload()}),this.registerStockCommandSources()},stockNavItems:null,navItems:[],secondaryNavItems:[],panelItems:[],registerNavItem:function(t){return this.stockNavItems||this.populateStockNavItems(),!this.addOrReplaceIfOverride(this.navItems,t)&&(!this.addOrReplaceIfOverride(this.stockNavItems.navItems,t)&&(this.navItems.push(t),!0))},registerPanel:function(t){return!this.addOrReplaceIfOverride(this.panelItems,t)&&(this.panelItems.push(t),!0)},registerSubNavItem:function(t){return this.stockNavItems||this.populateStockNavItems(),!this.addOrReplaceIfOverride(this.secondaryNavItems,t)&&(!this.addOrReplaceIfOverride(this.stockNavItems.secondaryNavItems,t)&&(this.secondaryNavItems.push(t),!0))},addOrReplaceIfOverride:function(t,e,s){var i=s||{id:e.id},n=_.findWhere(t,i);return!!n&&(e.override&&(t.splice(t.indexOf(n),1),t.push(e)),!0)},registerNavItems:function(t){var e=this,s=!1;t&&(t.nav&&_.each(t.nav,function(t){e.registerNavItem(t)&&(s=!0)}),t.subNav&&_.each(t.subNav,function(t){e.registerSubNavItem(t)&&(s=!0)}),t.panels&&_.each(t.panels,function(t){e.registerPanel(t)}),s&&this.trigger("navItemsChanged"))},getNavItems:function(){return this.populateStockNavItems(),{navItems:_.chain(this.stockNavItems.navItems).union(this.navItems).sortBy("position").value(),secondaryNavItems:_.chain(this.stockNavItems.secondaryNavItems).union(this.secondaryNavItems).sortBy("position").value()}},getPanelItems:function(){return this.panelItems},registerStockCommandSources:function(){this.registerPanel({id:"trello",section:"todo",cmd:"settings.panels.trello.config"})},populateStockNavItems:function(){var t=i.conditionalFeatures.featureEnabled("plus");if(!this.stockNavItems){var e=[],s=[];s=t?(e=[{id:"general",title:"General",cmd:"settings.panels.general",position:10},{id:"todo",title:"Todo",cmd:"settings.panels.todo",position:20},{id:"mantra-settings",title:"Mantras",cmd:"settings.panels.mantras",position:30},{id:"background-settings",title:"Photos",cmd:"settings.panels.backgrounds",position:40},{id:"quote-settings",title:"Quotes",cmd:"settings.panels.quotes",position:50},{id:"bookmark-settings",title:"Links",cmd:"settings.panels.bookmarks",position:70},{id:"balance",title:"Balance",cmd:"settings.panels.balance",position:80}],[{id:"help",title:"Help",cmd:"settings.panels.help",position:10},{id:"whatsnew",title:"What’s New",cmd:"settings.panels.whatsnew",position:20},{id:"about",title:"About",cmd:"settings.panels.about",position:30}]):(e=[{id:"general",title:"General",cmd:"settings.panels.general",position:10},{id:"todo",title:"Todo",cmd:"settings.panels.todo",position:20},{id:"mantra-settings",title:"Mantras",cmd:"settings.panels.mantras",position:30},{id:"background-settings",title:"Photos",cmd:"settings.panels.backgrounds",position:40},{id:"quote-settings",title:"Quotes",cmd:"settings.panels.quotes",position:50},{id:"bookmark-settings",title:"Links",cmd:"settings.panels.bookmarks",position:70},{id:"balance",title:"Balance",cmd:"settings.panels.balance",position:80}],[{id:"help",title:"Help",cmd:"settings.panels.help",position:10},{id:"whatsnew",title:"What’s New",cmd:"settings.panels.whatsnew",position:20},{id:"about",title:"About",cmd:"settings.panels.about",position:30},{id:"upgrade",title:"Upgrade to Plus",cmd:"upsell.website",cmdonly:!0,options:{source:"nav-upgrade-plus"},position:40}]),this.stockNavItems={navItems:e,secondaryNavItems:s}}},infinispin:function(){var t=localStorage.getItem("infinispin");return t=!!t&&JSON.parse(t)},toggleInfinispin:function(){var t=!this.infinispin();return localStorage.setItem("infinispin",t),t}}),i.settingsManager=new s.models.SettingsManager,s};m.addinManager&&m.addinManager.registerAddinFn("9e4cdd4d-8e0d-4b36-a159-fab66de84970",fn_addin);